<!--
    This Page is created to edit Activiy and Sub Activity
    Created Date:-9/01/2017
    Created by:-  Roshi Rai
    -->
    <apex:page controller="TitanNDPEditPageControllernewclone" id="pageId" showHeader="false" sidebar="false">
       
       
      
        <style type="text/css">
        @media screen and (min-width: 1500px) and (max-width: 1800px) 
 { 
 .ScrollStyleDynamic
 {max-width:1200px!important;}
 .btn_outer_line{margin-left: 58px;}
}


//Add style after this

.popupBackground {
            /* Background color */
            background-color: black;
            opacity: 0.20;
            filter: alpha(opacity=20);
            /* Dimensions */
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 998;
            position: absolute;
            /* Mouse */
            cursor: wait;
        }
        /* This is for the message DIV */
        
        .PopupPanel {
            /* Background color */
            /* border: solid 2px blue;*/
            left: 50%;
            width: 200px;
            margin-left: -100px;
            top: 50%;
            height: 250px;
            margin-top: -25px;
            z-index: 999;
            position: fixed;
            /* Mouse */
            cursor: pointer;
        }
        
       .t_lookup a {
          border: none!important;
          background: transparent!important;
          padding: 0!important;
          width: 20px !important;
       }
       
       .t_lookup a:focus {
          background-color: transparent!important;
          box-shadow: none!important;
          outline: 0px;
          border-color: transparent!important;
       }
       
       .widthdynamiclarge .b
       {width: 100%;
        float: right;
        
        }
        
         div.hideCurrDate span.dateInput span.dateFormat {
          display: none;
       }
       
      
       
       .ScrollStyle {
          background-color: lightyellow!important;
          max-height: 400px;
          max-width: 300px;
          overflow-y: scroll;
       }
       
       .ScrollStyleDynamic {
          background-color: #f8f8f8!important;
          max-height: 290px;
           max-width: 1023px;
          overflow-y: scroll;
          
          width: 76% !important;
          float: right;
       }
       
       

       
       
       .customPopup {
          height: 400px;
          left: 4%;
          padding: 100px;
          position: fixed;
          top: 1%;
          width: 60%;
          z-index: 9999;
          border-radius: 10px;
          margin-left: 977px !important;
          margin-top: -84px !important;
       }
       
       a.theHideIcon {
          display: none !important;
       }
       
       .someClass {
          width: 90px;
          word-break: break-all;
       }
       
       .Date {
          width: 101px !important;
       }
       
       .Name {
          width: 131px !important;
       }
       
       .Number {
          width: 60px !important;
       }
       
       .Status {
          width: 90px !important;
       }
       
       .border {
          border-bottom: 1pt solid black !important;
       }
       
       .activityspace td,
       .activityspace th {
          padding: 0px;
          height: 10px;
       }
       
       .stagespace td,
       .activityspace th {
          padding: 0px;
       }
       
       .message{
        position: fixed;
            top: 0;
            z-index: 9999;
        }

       </style>
       
       <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="theId" style="height:1000px">

       <head>
          <title>Salesforce Lightning</title>
          <apex:stylesheet value="{!URLFOR($Resource.SLDSNPD,'assets/styles/salesforce-lightning-design-system-vf.css')}"
          />
          <apex:stylesheet value="{!URLFOR($Resource.NPDCss,'NPDCss/DatePickercss.css')}" /> </head>
          
           
            
       <script type="text/javascript">
       function popupforassigntask(taskid)
        {     
            
            var url="/apex/popupforassigntask?"+"&taskid="+taskid;
            newWin=window.open(url, 'Popup3','height=400,width=300,left=100,top=50,resizable=no,scrollbars=yes,toolbar=no,status=no');
            
            if (window.focus) 
            {
                newWin.focus();
            }    
            
            return false;
        }
       function setTitleToValue(el)
       {
          var brandVal = el.options[el.selectedIndex].text;
          if(brandVal != '')
          {
             //alert(brandVal);
             document.getElementById('pageId:theForm:modlenum').disabled = true;
          }
          if(brandVal == '--None--')
          {
             document.getElementById('pageId:theForm:modlenum').disabled = false;
          }
       }

       function addCondidtion()
       {
          var modelname = document.getElementById('pageId:theForm:modlenum').value;
          //alert(modelname);
          if(modelname != '')
          {
             document.getElementById('pageId:theForm:brandselection').disabled = true;
             document.getElementById('pageId:theForm:selectedcollection').disabled = true;
          }
          else
          {
             document.getElementById('pageId:theForm:brandselection').disabled = false;
             document.getElementById('pageId:theForm:selectedcollection').disabled = false;
          }
       }
       </script>
       
         <apex:actionStatus id="actStatusId" stopText="">
        <apex:facet name="start">
            <div>
                <div class="popupBackground" />
                <div class="PopupPanel">
                    <table border="0" width="100%" height="100%">

                        <tr>
                            <!-- <td align="center"><img src="{!$Resource.Spinner}"/></td>-->
                            <td align="center"><img src="/img/loading.gif" /></td>
                        </tr>
                    </table>
                </div>
            </div>
        </apex:facet>
    </apex:actionStatus>
       
       <div id="preloader" style="display:none"  width="50" height="50">     
           <apex:image id="theImage" value="{!$Resource.loader}" style="position: absolute;z-index: 45;top: 50%;left: 50%;margin: -100px 0 0 -100px;height: 30px;"/>     
        </div>
       <div class="slds NPD" style="background-color: #f7f9fb;" height="100%" width="100%">
          <apex:form id="theForm">
             <div class="slds-page-header" role="banner">
                <div class="slds-media slds-media--center">
                   <div class="slds-media__figure"> 
                                   <apex:image url="{!$Resource.TitanImage}" width="30" height="30"/>

                                </div> 
                   <div class="slds-media__body">
                 <!--     <p class="slds-text-title--caps slds-line-height--reset">PDMS</p> -->
                      <h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate" title="PDMS Tool">TITAN PDMS 
                      <apex:outputText value="Hi, You have logged in as {!sfUserName}" style=" height: 30px;width: 20;padding-right: 22px;padding-left: 22px;margin-left: 260px;"/>
                      <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Click Back to Home Page" action="{!homePage}" style="height: 30px;width: 20;padding-right: 22px;padding-left: 22px;margin-left: 300px;" status="actStatusId" />
                      </h1>
                   </div>
                </div>
             </div>
             <div class="slds-m-around--x-small">
                <fieldset class="slds-form--compound">
                   <div class="slds-form-element__group">
                      <div class="slds-form-element__row">
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Brand"><b>Brand</b></span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:outputPanel id="Brand">
                                           <!--onchange="javascript:setTitleToValue(this)"-->
                                           <apex:selectList size="1" id="brandselection" styleClass="slds-input" value="{!selectedBrandName}">
                                              <apex:selectoptions value="{!npdBrandOption}" />
                                              <apex:actionSupport event="onchange" oncomplete="javascript:setTitleToValue(this)"
                                                 action="{!selectCollection}" reRender="collectionId" status="actStatusId" /> </apex:selectList>
                                        </apex:outputPanel>
                                     </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Collections"><b>Collections</b></span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:outputPanel id="collectionId">
                                           <apex:selectList size="1" id="selectedcollection" styleClass="slds-input" value="{!selectedCollectionName}"
                                              style="width: 275px;">
                                              <apex:selectoptions value="{!npdCollectionOption}" />
                                              <apex:actionSupport event="onchange" action="{!selectCollection}" reRender="collectionId,TableRecordId"
                                                 status="actStatusId" /> </apex:selectList>
                                        </apex:outputPanel>
                                     </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Modelnum"><b>Model</b></span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:outputPanel >
                                           <!--onkeyup="addCondidtion();"  onclick="addCondidtion();"-->
                                           <apex:inputText id="modlenum" value="{!modelNum}" styleClass="slds-input" onkeyup="addCondidtion();"
                                              onclick="addCondidtion();">
                                              <!--<apex:actionSupport event="onchange" action="{!dummymodel}"  rerender="xyz" status="actStatusId" />--></apex:inputText>
                                        </apex:outputPanel>
                                     </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Owner"><b>Ownership</b></span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:outputPanel id="ownerid">
                                           <apex:selectList size="1" styleClass="slds-input" value="{!selectedOwner }">
                                              <apex:selectoptions value="{!npdOwnerOption }" />
                                              <apex:actionSupport event="onchange" action="{!selectOwner}" reRender="collectionId,TableRecordId"
                                                 status="actStatusId" /> </apex:selectList>
                                        </apex:outputPanel>
                                     </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Type"><b>Type</b></span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:outputPanel id="Typeid">
                                           <apex:selectList styleClass="slds-input" size="1" id="myPicklist" value="{!selectedType}"
                                              onchange="PicklistChanged();">
                                              <apex:selectoptions value="{!npdTypeOption }"/>
                                                 <apex:actionSupport event="onchange" action="{!dummy}" reRender="collectionId,TableRecordId"
                                                    status="actStatusId" /> <!--</apex:selectoptions> -->
                                           </apex:selectList>
                                        </apex:outputPanel>
                                     </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Type">   </span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:image id="theImagestatus" value="{!$Resource.search_icon}" width="32" height="32"
                                           onclick="displaymodelinfo();" style="cursor:pointer;margin-top: 15px;margin-left: -1px;"
                                        /> </div>
                                  </div>
                               </div>
                            </div>
                         </div>
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <div class="slds-form-element slds-size--1-of-4">
                               <div class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true"> <span class="slds-form-element__label" title="Type">   </span>
                                  <div class="slds-form-element">
                                     <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                        <apex:image value="{!imagepiclink}"  rendered="{!if(imagepiclink !=NULL,True,False)}" style="width: 51px;height: 44px;background-color: aliceblue;margin-left: -122px;margin-top: 9px;"
                                           onmouseover="showimage();" onmouseout="hideimage();"  /> </div>
                                     <apex:outputPanel styleClass="popup21" style="display:none;">
                                        <apex:outputPanel styleClass="customPopup" layout="block">
                                           <table>
                                              <tr>
                                                 <td id="rich2">
                                                    <!-- <apex:outputField value="{!currentProject.ImageUpload__c}" /> -->
                                                    <apex:image value="{!imagepiclink}" style="left:10px;top:10px;" /> </td>
                                              </tr>
                                           </table>
                                        </apex:outputPanel>
                                     </apex:outputPanel>
                                  </div>
                               </div>
                            </div>
                         </div>
                      </div>
                   </div>
                </fieldset>
             </div>
          </apex:form>
       </div>
   <!--    <apex:actionStatus id="actStatusId" onstart="loaderEnable()" onstop="loaderUnable()">
       </apex:actionStatus> -->
       <!--**************SEARCH TABLE***************************************************-->
      <!-- <apex:pageMessages id="messages" /> -->
       <!--**************MODLE TABLE***************************************************-->
       <apex:outputPanel id="panel2">
      <!-- <apex:pageMessages id="messagesall" /> twice message appear--> 
          <apex:outputPanel rendered="{!showmodel}">
             <apex:variable var="dyId" value="{!0}" />
             <div class="slds NPD" height="100%">
                <div class="slds-grid slds-wrap" id="theDivId">
                   <div class="">
                      <div class="slds-form--stacked">
                         <table class="slds-table slds-table--bordered slds-max-medium-table--stacked">
                            <apex:repeat value="{!ModleNameDetails}" var="mdname">
                               <th scope="col" width="">
                                  <!--class="someClass"--><button id="Button1{!dyId}" class="slds-button slds-button--neutral slds-not-selected someClass"
                                     style="background-color: #4ca64c;color: white;" immediate="true" onclick="showActivity('{!mdname.id}','{!mdname.Name}','{!dyId}');return false;"
                                    status="actStatusId" rendered="outAct,outstage" >
                                                          <span class="slds-text-not-selected">
                                                       
                                                         <apex:outputtext value="{!If(mdname.Name =="Marketing Brief/Concept Stage", "MB Stage",mdname.Name)}"/> 
                                                        
                                                   </span> 
                                                    </button> </th>
                               <apex:variable var="dyId" value="{!dyId+1}" /> </apex:repeat>
                         </table>
                      </div>
                   </div>
                </div>
             </div>
          </apex:outputPanel>
       </apex:outputPanel>
       
       <apex:form id="mainform">
      <!-- <apex:pageMessages id="messages" /> twice mesge-->
          <div class="slds NPD">
             <div class="slds-m-around--x-small">
                <fieldset class="slds-form--compound">
                   <div class="slds-form-element__group">
                      <div class="slds-form-element__row">
                         <div class="slds-form-element__col slds-size--1-of-4 slds-m-around--x-small">
                            <!--***************STAGE AND SUB-STAGE TABLE*******************************************************-->
                            <apex:outputPanel id="outstage">
                               <apex:outputPanel rendered="{!showstage}" id="DetailPanelstage" style="overflow:scroll;height:50px;width:50px;">
                                  <div class="slds NPD ScrollStyle">
                                     <div class="slds-grid slds-wrap" id="theDivId">
                                        <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                           <div class="slds-form--stacked">
                                              <table class="slds-max-medium-table--stacked stagespace" style="width: 300px;">
                                                 <thead>
                                                    <apex:repeat value="{!lstStage}" var="Stage">
                                                       <tr style="height: 25px;">
                                                          <th style="width: 10px;"  > 
                                                            <apex:image id="theImagestatus"  value="{!If(Stage.Status__c== "Not Started", $Resource.NotStarted, If(Stage.Status__c =="In Progress", $Resource.Inprogress, $Resource.completed))}"  width="15" height="15" />
                                                            <apex:image id="theImage" value="{!If(Stage.Type__c== "Stage", $Resource.req,$Resource.substageline)}" width="20" height="18"/>
                                                            <apex:outputLink value="{!Stage.Name__c}"   onclick="showstName('{!Stage.Name__c}','{!Stage.Type__c}','{!Stage.id}','{!Stage.Revision_Substage__c}');return false;" >{!Stage.Name__c}</apex:outputLink>
                                                        </th>
                                                       </tr>
                                                    </apex:repeat>
                                                 </thead>
                                              </table>
                                           </div>
                                        </div>
                                     </div>
                                  </div>
                               </apex:outputPanel>
                            </apex:outputPanel>
                            <!--***************ACTIVITY AND SUB ACTIVITY TABLE*******************************************************-->
                            <apex:outputPanel id="outAct">
                               <apex:outputPanel rendered="{!showAct}" id="DetailPanelAct">
                                  <div class="slds NPD ScrollStyle">
                                     <div class="slds-grid slds-wrap" id="theDivId">
                                        <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2"
                                           style="background-color: lightyellow;">
                                           <div class="slds-form--stacked">
                                              <table class="slds-max-medium-table--stacked activityspace">
                                                 <thead>
                                                    <apex:repeat value="{!lstActivty }" var="Stage">
                                                       <tr style="height: 25px;">
                                                          <th style="width: 10px;">
                                                                <apex:image id="theImagestatus"  value="{!If(Stage.Status__c== "Not Started", $Resource.NotStarted, If(Stage.Status__c =="In Progress", $Resource.Inprogress, $Resource.completed))}"  width="15" height="15" />
                                                                <apex:image id="theImage" value="{!If(Stage.Type__c== "Activity", $Resource.req,$Resource.substageline)}" width="20" height="18"/>
                                                                <apex:outputLink style="someClass"  value="{!Stage.Name__c}" onclick="showActName('{!Stage.Name__c}','{!Stage.Type__c}','{!Stage.id}','{!Stage.Revision_Active__c}');return false;">{!Stage.Name__c}</apex:outputLink>
                                                            </th>
                                                       </tr>
                                                    </apex:repeat>
                                                 </thead>
                                              </table>
                                           </div>
                                        </div>
                                     </div>
                                  </div>
                               </apex:outputPanel>
                            </apex:outputPanel>
                         </div>
                         
                         <!------------------------------Stage Screen----------------------------------------------------------------------------------->
                        
                         <div class="slds-form-element__col slds-size--1-of-5 slds-m-around--x-small"    style="width: 509px;">
                          
                            <apex:outputPanel id="scrstage">
                           
                               <apex:outputPanel rendered="{!showstagescreen}" id="screenstage" style="overflow:scroll;height:50px;width:50px; ">
                                  <apex:pageMessages id="messagepage"  ></apex:pageMessages>
                                  <div class="slds NPD" height="100%">
                                     <div class="slds-grid slds-wrap" id="theDivId">
                                        <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-5 slds-large-size--1-of-5">
                                           <div class="slds-form--stacked"> <br/>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <apex:repeat value="{!record}" var="Stage">
                                                    <tr class="">
                                                     
                                                       <td style="width:90%;text-align:center;">
                                                             <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Save" rendered="{!AND(Stage.Active__c,Stage.Approval_Status__c!='Pending',Stage.Type__c=='Stage')}" status="actStatusId"  reRender="scrstage,outstage" oncomplete="callhideCol();" action="{!saveStage}" style=" height: 33px;width: 0;padding-right: 49px;padding-left: 22px;margin-left: 156px;"  />

                                                                     
                                                            <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Save" rendered="{!AND(Stage.Active__c==true,Stage.NPD_Stage__r.Active__c==true,Stage.Type__c=='Sub-stage')}" status="actStatusId"  reRender="scrstage,outstage" oncomplete="callhideCol();" action="{!saveStage}" style=" height: 33px;width: 0;padding-right: 49px;padding-left: 22px;margin-left: 156px;" />                                                           
                                                             </td>
                                                             
                                                        
                                                             
                                                              <td >
                                                            
                                                             <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Submit for Approval"    rendered="{!AND(Stage.Approval_Required__c,(Stage.Approval_Status__c=='None' || Stage.Approval_Status__c=='Re-Submit'),Stage.design_manager_npd_master__c!= NULL)}"  oncomplete="callhideCol();" reRender="scrstage"    onClick="callApprovalProcess()"   style="width: 147px;" status="actStatusId" />                                                        
                                                              </td> 
                                                             
                                                       <td style="width:10%;text-align:right;"><apex:outputPanel >
                                                          <apex:commandLink value="Click to Activate" immediate="true" oncomplete="callhideCol();" reRender="scrstage,messagepage" action="{!activateStage}" rendered="{!if(AND(Stage.Active__c ==false,Stage.Type__c=='Stage'),true,false)}"> </apex:commandLink></apex:outputPanel>
                                                          
                                                        <apex:outputPanel >  <apex:commandLink value="Click to Deactivate" immediate="true"   reRender="scrstage,messagepage" oncomplete="callhideCol();" action="{!activateStage}" rendered="{!AND(Stage.Active__c,Stage.Type__c=='Stage')}"> </apex:commandLink></apex:outputPanel>
                                                        
                                                        <apex:outputPanel >
                                                          <apex:commandLink value="Click to Activate" immediate="true" oncomplete="callhideCol();" reRender="scrstage,messagepage" action="{!activateStage}" rendered="{!if (AND (Stage.Active__c ==false,Stage.NPD_Stage__r.Active__c ==true,Stage.Type__c=='Sub-stage'),true,false)}"> </apex:commandLink></apex:outputPanel>
                                                          
                                                        <apex:outputPanel >  <apex:commandLink value="Click to Deactivate" immediate="true"   reRender="scrstage,messagepage" oncomplete="callhideCol();" action="{!activateStage}" rendered="{!AND(Stage.Active__c==true,Stage.NPD_Stage__r.Active__c==true,Stage.Type__c=='Sub-stage')}"> </apex:commandLink></apex:outputPanel>
                                                       
                                                       <script>
                                                      
                                                        function callhideCol(){
                                                           
                                                             if(revisionsubActive == 'false') {
                                                             // alert('afterapproval'+document.getElementById("Revision").style.display);
                                                              document.getElementById("Revision").style.display = "none";
                                                           }
                                                           if(stageNameVar != 'abc') {
                                                              document.getElementById("R1ASDdate").style.display = "none";
                                                              document.getElementById("R1AEDdate").style.display = "none";
                                                              document.getElementById("R2ASDdate").style.display = "none";
                                                              document.getElementById("R2AEDdate").style.display = "none";
                                                           }
                                                           
                                                          
                                                           if(stageNameVar != 'Case Development - INH') {
                                                              document.getElementById("ComplexityCategory").style.display = "none";
                                                           }
                                                           if(typeVar == 'Stage') {
                                                              document.getElementById("complexity").style.display = "none";
                                                           }
                                                           if(stageNameVar != 'Marketing Brief/Concept') {
                                                              document.getElementById("dsnmanager").style.display = "none";
                                                           }
                                                           if(stageNameVar == 'Concept Design - IDS') {
                                                              //alert('heloohelooheloohelooheloo');
                                                              document.getElementById("actcol").style.display = "";
                                                           }
                                                        }
                                                       </script>
                                                       
                                                       </td>
                                                    </tr>
                                                    </apex:repeat>
                                                    </table>
                                                    <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <apex:repeat value="{!record}" var="Stage">
                                                    
                                                 
                                                    <tr>
                                                       <td style="width:10%;" colspan="5">
                                                      
                                                         
                                                             <apex:outputtext value="{!if(selectedType=='Stage',Stage.Name__c,Stage.NPD_Stage__r.Name__c +'-->'+Stage.Name__c)}"
                                                             style="color:Orange;" />  </td>
                                                      
                                                    </tr>
                                                    <tr>
                                                  
                                                              <td style="width:10%;display:none" colspan="5" >
                                                          <input id="typestage" value="{!Stage.Type__c}"
                                                             style="color:Orange;" /> </td>
                                                             
                                                             <td style="width:10%;display:none" colspan="5" >
                                                          <input id="namestage" value="{!Stage.Name__c}"
                                                             style="color:Orange;" /> </td>
                                                       
                                                       
                                                         <td style="width:10%;display:none" colspan="5" >
                                                          <input id="revActstage" value="{!Stage.Revision_Active__c}"
                                                             style="color:Orange;" /> </td>
                                                    
                                                     <td style="width:10%"> <label class="col-md-6">
                                                          Planned
                                                             Start
                                                             Date</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Date" value="{0,date,dd'/'MMM'/'yy}">
                                                                <apex:param value="{!Stage.Planned_Start_Date__c}" /> </apex:outputText>
                                                          </div>
                                                       </td>
                                                       <td style="width:10%"> <label class="col-md-6" >
                                           Actual
                                              Start
                                              Date</label>
                                                          <div class="col-md-6 text" >
                                                             <apex:outputtext styleclass="slds-input Date" value="{0,date,dd'/'MMM'/'yy}">
                                                                <apex:param value="{!Stage.Actual_Start_Date__c}" /> </apex:outputText>
                                                          </div>
                                                       </td>
                                                        <td style=""> <label class="col-md-6"> Status</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Status" value="{!Stage.Status__c}">
                                                             </apex:outputText>
                                                          </div>
                                                       </td>
                                                       
                                                       <td style="width:10%;"> <label class="col-md-6" > Tentative Launch Plan</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Date" value="{0,date,dd'/'MMM'/'yy}">
                                                                <apex:param value="{!Stage.Tentative_Launch_Plan__c}" /> </apex:outputText>
                                                          </div>
                                                       </td>
                                                       <td style="width: 60%;"> <label class="col-md-6">  Collection reference</label>
                                                          <div class="col-md-6 text " style="width: 234px;">
                                                             <apex:outputtext styleclass="slds-input" value="{!Stage.Collection_reference__c}">
                                                             </apex:outputText>
                                                          </div>
                                                       </td>
                                                    </tr>
                                                    <tr>
                                                      <td style=""> <label class="col-md-6"> Planned End Date</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Date" value="{0,date,dd'/'MMM'/'yy}">
                                                                <apex:param value="{!Stage.Planned_End_Date__c}" /> </apex:outputText>
                                                          </div>
                                                       </td>
                                                       <td style=""> <label class="col-md-6">  Actual End Date</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Date" value="{0,date,dd'/'MMM'/'yy}">
                                                                <apex:param value="{!Stage.Actual_End_Date__c}" /> </apex:outputText>
                                                          </div>
                                                       </td>
                                                       <td style="width:10%;"> <label class="col-md-6" > Approval Status</label>
                                                          <div class="col-md-6 text">
                                                             <apex:outputtext styleclass="slds-input Status" value="{!Stage.Approval_Status__c}">
                                                             </apex:outputText>
                                                          </div>
                                                       </td>
                                                      
                                                       <td style=""> <label class="col-md-6">  No of Designs</label>
                                                          <div class="col-md-6 text">
                                                             <apex:inputtext styleclass="slds-input Number border" value="{!Stage.No_of_Designs__c}">
                                                             </apex:inputtext>
                                                          </div>
                                                       </td>
                                                       <td id="mbrefn" > <label class="col-md-6" > MB Ref Number</label>
                                                          <div class="col-md-6  text" >
                                                             <apex:outputtext styleclass="slds-input Date" value="{!Stage.Marketing_brief_concept_reference_number__c}"
                                                             /> </div>
                                                       </td>
                                                      
                                                       <tr class="slds-text-heading--label border">
                                                          <td colspan="6">
                                                             
                                                          </td>
                                                         
                                                       </tr>
                                                       <tr>
                                                          <td id="complexity" > <label class="col-md-6"> Complexity </label>
                                                             <div class="col-md-6 text">
                                                                <div class="col-md-6 text">
                                                                   <apex:inputField styleClass="bordernone inputui slds-input Status"
                                                                      value="{!Stage.Complexity_Typess__c}" id="comType3">
                                                                      <apex:image styleClass="lookupimg" url="{!$Resource.LookupIcon}"
                                                                         width="20" height="20" onclick="openComplexityTypePopup('{!$Component.comType3}','{!$Component.comCat2}','{!$Component.lead2}','{!Stage.Name__c}','{!Stage.Type__c}','{!Stage.Source__c}')"
                                                                      />
                                                                      <script>
                                                                      document.getElementById('{!$Component.comType3}').disabled =
                                                                         true;
                                                                      </script>
                                                                   </apex:inputField>
                                                                </div>
                                                             </div>
                                                          </td>
                                                          <td id="ComplexityCategory" > <label class="col-md-6">Complexity Category</label>
                                                             <div class="col-md-6 text">
                                                                <div class="col-md-6 text">
                                                                   <div class="col-md-6 text" >
                                                                      <apex:inputField styleclass="slds-input Status" value="{!Stage.Complexity_Category__c}"
                                                                         id="comCat2">
                                                                         <apex:image url="{!$Resource.LookupIcon}" styleClass="lookupimg"
                                                                            width="20" height="20" onclick="openComplexityPopup('{!$Component.comType3}','{!$Component.comCat2}','{!$Component.lead2}','{!Stage.Name__c}','{!Stage.Type__c}')"
                                                                         /></apex:inputField>
                                                                   </div>
                                                                </div>
                                                             </div>
                                                          </td>
                                                          <td> <label class="col-md-6"> Planned Lead Time</label>
                                                             <div class="col-md-6 text">
                                                                <apex:outputtext id="Lead2" styleClass="inputui slds-input Number"
                                                                   value="{!Stage.Planned_Lead_Time__c}" /> </div>
                                                          </td>
                                                          <td > <label class="col-md-6"> Actual Lead Time</label>
                                                             <div class="col-md-6 text">
                                                                <div class="col-md-6 text">
                                                                   <apex:outputtext id="Lead1" styleclass="slds-input Number" value="{!Stage.Actual_Lead_Time__c}"
                                                                   /> </div>
                                                             </div>
                                                          </td>
                                                          <td > <label class="col-md-6">Ownership</label>
                                                             <div class="col-md-6 text t_lookup">
                                                                <apex:inputField styleclass="slds-input Status" value="{!Stage.NPD_User__c}">
                                                                </apex:inputField>
                                                             </div>
                                                          </td>
                                                          <td id="dsnmanager" > <label class="col-md-6"> Design Manager</label>
                                                             <div class="t_lookup ">
                                                             <!--required="{!if(Stage.Name__c='Marketing Brief/Concept',true,false)}"-->
                                                                <apex:inputField styleclass="slds-input Status" value="{!Stage.design_manager_npd_master__c}" required="{!if(Stage.Name__c='Marketing Brief/Concept',true,false)}" >
                                                                </apex:inputField>
                                                             </div>
                                                          </td>
                                                          
                                                       </tr>
                                                        <tr class="slds-text-heading--label border">
                                                          <td colspan="6">
                                                             <div class="slds-truncate" data-label="Serial"> </div>
                                                          </td>
                                                          
                                                       </tr>
                                                       <tr>
                                                          <td id="brandId" > <label id="brandId" class="col-md-6"> Brand</label>
                                                             <div class="col-md-6  text">
                                                                <apex:outputtext styleclass="slds-input" style="width: 101px;"
                                                                   value="{!Stage.Brand1__c}" /> </div>
                                                          </td>
                                                         
                                                          <td id="Subbrand" > <label class="col-md-6"> Sub Brand</label>
                                                             <div class="col-md-6  text">
                                                                <apex:outputtext styleclass="slds-input Status" value="{!Stage.Sub_Brand1__c}"
                                                                /> </div>
                                                          </td>
                                                          
                                                          <td id="marketid" > <label class="col-md-6" > Market</label>
                                                             <div class="col-md-6 text">
                                                                <apex:outputtext styleclass="slds-input Status" value="{!Stage.Market__c}">
                                                                </apex:outputtext>
                                                             </div>
                                                          </td>
                                                          <td > <label class="col-md-6" > Phase</label>
                                                             <div class="col-md-6 text" >
                                                                <apex:outputtext styleclass="slds-input Status" value="{!Stage.Phase__c}">
                                                                </apex:outputText>
                                                             </div>
                                                          </td>
                                                          <td > <label class="col-md-6" >  Source</label>
                                                             <div class="col-md-6 text">
                                                                <apex:outputText styleclass="slds-input Status" value="{!Stage.Source__c}">
                                                                </apex:outputText>
                                                             </div>
                                                          </td>
                                                          
                                                          
                                                       </tr>
                                                       <tr>
                                                          <td id="Revision"> <label class="col-md-6"> Revision Status</label>
                                                             <div class="col-md-6 text ">
                                                                <apex:inputField id="revisionstage" styleclass="slds-input" style="width: 123px;"
                                                                   value="{!Stage.Revision_Status__c}" onchange="displayRevicionSubstageDate('{!$Component.revisionstage}');"
                                                                /> </div>
                                                          </td>
                                                          <td id="R1ASDdate"> <label class="col-md-6"> R1 Start Date</label>
                                                             <div class="col-md-6 text hideCurrDate">
                                                                <apex:inputField styleclass="slds-input date" style="width: 123px;"
                                                                   value="{!Stage.R1_ASD__c}" /> </div>
                                                          </td>
                                                          <td id="R1AEDdate"> <label class="col-md-6"> R1 End date</label>
                                                             <div class="col-md-6 text hideCurrDate">
                                                                <apex:inputField styleclass="slds-input date" style="width: 123px;"
                                                                   value="{!Stage.R1_AED__c}" /> </div>
                                                          </td>
                                                          <td id="R2ASDdate"> <label class="col-md-6"> R2 Start Date</label>
                                                             <div class="col-md-6 text hideCurrDate">
                                                                <apex:inputField styleclass="slds-input date" style="width: 123px;"
                                                                   value="{!Stage.R2_ASD__c}" /> </div>
                                                          </td>
                                                          <td id="R2AEDdate"> <label class="col-md-6"> R2 End date</label>
                                                             <div class="col-md-6 text hideCurrDate">
                                                                <apex:inputField styleclass="slds-input date" style="width: 123px;"
                                                                   value="{!Stage.R2_AED__c}" /> </div>
                                                          </td>
                                                       </tr>
                                                       <tr class="slds-text-heading--label border">
                                                          <td colspan="6">
                                                             <div class="slds-truncate" data-label="Serial"> </div>
                                                          </td>
                                                          
                                                       </tr>
                                                    </tr>
                                                    <tr>
                                                       <td colspan="5"> <label class="col-md-6">Comments/Remarks</label>
                                                          <div class="col-md-6 text">
                                                             <apex:inputField styleclass="slds-input"  style="width: 450px " value="{!Stage.Comments_Remarks__c}">
                                                             </apex:inputField>
                                                          </div>
                                                       </td>
                                                       <td> </td>
                                                       <td> </td>
                                                    </tr>
                                                    <tr>
                                                    <td>
                                                    <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" 
                                                       value="Attachment" action="{!viewattachment}" rerender="attpanal1,attpanal11,attpanalstage" rendered="{!if(Stage.Name__c='Marketing Brief/Concept',true,false)}" 
                                                       status="actStatusId" style="margin-left: -9px;margin-top: 18px;margin-bottom: -6px;" />
                                                    </td>
                                                    </tr>
                                                 </apex:repeat>
                                              </table>
                                           </div>
                                        </div>
                                     </div>
                                  </div>
                                   
                               </apex:outputPanel>
                            </apex:outputPanel>
                            <!--***************************************Activity Block***************************************************************************-->
                            <apex:outputPanel id="scract">
                               <apex:outputPanel rendered="{!showActscreen}" id="screenact" style="overflow:scroll;height:50px;width:50px;">
                               <apex:pageMessages id="messagepageAct"  ></apex:pageMessages>
                                  <div class="slds stockit" height="100%">
                                     <div class="slds-grid slds-wrap" id="theDivId">
                                        <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                           <div class="slds-form--stacked">
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr class="">
                                                    <td> </td>
                                                    <td style="width:90%;text-align:center;"> 
                                                  <apex:commandButton value="Save" action="{!saveActivity}"  oncomplete="hidecolactivity();"  rerender="scract,outAct,messagepageAct" rendered="{!AND(recordact.Active__c,recordact.NPD_Stage__r.NPD_Stage__r.Active__c==true,recordact.NPD_Stage__r.Active__c==true,recordact.Approval_Status__c!='Pending')}" style="height: 29px;width: 0;padding-right: 46px;padding-left: 22px;margin-left: -435px;background-color: aliceblue;margin-top: -7px;" />
                                                
                                             </td>
                                             
                                              <td>
                                                  <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Submit for Approval"    rendered="{!AND(recordact.Active__c,recordact.NPD_Stage__r.NPD_Stage__r.Active__c==true,recordact.NPD_Stage__r.Active__c==true,recordact.Approval_Required__c,(recordact.Approval_Status__c=='None'||recordact.Approval_Status__c=='Re-Submit'),recordact.Actual_Start_Date__c!=NULL,recordact.Approval_Status__c!='Pending')}"  oncomplete="hidecolactivity();"    action="{!approvalitems}"   style="width: 147px;" status="actStatusId"  rerender="scract,messagepageAct,buttonform"  />                                                        
                                              </td>
                                                    <td style="width:10%;text-align:right;">
                                                     <apex:outputPanel >   
                                                     <apex:commandLink value="Click to ActivateAct" immediate="true" oncomplete="hidecolactivity();"  rerender="scract,messagepageAct"  action="{!activateActivity}" rendered="{!if(AND(recordact.Active__c==false,recordact.NPD_Stage__r.NPD_Stage__r.Active__c==true,recordact.NPD_Stage__r.Active__c==true,recordact.Approval_Status__c!='Pending'),true,false)}" > 
                                                     </apex:commandLink>
                                                     </apex:outputPanel>
                                                      
                                                    <apex:outputPanel > 
                                                     <apex:commandLink value="Click to Deactivate"  immediate="true"  rerender="scract,messagepageAct" oncomplete="hidecolactivity();" action="{!activateActivity}"  rendered="{!if(AND(recordact.Active__c==true,recordact.NPD_Stage__r.NPD_Stage__r.Active__c==true,recordact.NPD_Stage__r.Active__c==true,recordact.Approval_Status__c!='Pending'),true,false)}" > 
                                                     </apex:commandLink>
                                                     </apex:outputPanel> 
                                                    <script>
                                                    
                                              
                                                    function hidecolactivity()
                                                    
                                                          {
                                                            if(revisionActive == 'false')
                                                             {
                                                                document.getElementById("Revision").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'abc')
                                                             {
                                                                document.getElementById("R1ASDdate").style.display = "none";
                                                                document.getElementById("R1AEDdate").style.display = "none";
                                                                document.getElementById("R2ASDdate").style.display = "none";
                                                                document.getElementById("R2AEDdate").style.display = "none";
                                                             }
                                                             
                                                             var revisionstatus = document.getElementById('pageId:mainform:revisionstate').value;
                                                                 if(revisionstatus == 'Activate R1')
                                                                 {
                                                                    document.getElementById("R1ASDdate").style.display = "";
                                                                    document.getElementById("R1AEDdate").style.display = "";
                                                                    document.getElementById("R2ASDdate").style.display = "none";
                                                                    document.getElementById("R2AEDdate").style.display = "none";
                                                                 }
                                                                 if(revisionstatus == 'Activate R2')
                                                                 {
                                                                    document.getElementById("R1ASDdate").style.display = "";
                                                                    document.getElementById("R1AEDdate").style.display = "";
                                                                    document.getElementById("R2ASDdate").style.display = "";
                                                                    document.getElementById("R2AEDdate").style.display = "";
                                                                 }
                                                                 if(revisionstatus == 'None')
                                                                 {
                                                                    document.getElementById("R1ASDdate").style.display = "none";
                                                                    document.getElementById("R1AEDdate").style.display = "none";
                                                                    document.getElementById("R2ASDdate").style.display = "none";
                                                                    document.getElementById("R2AEDdate").style.display = "none";
                                                                 }
                                                             if(stageNameVar == 'Briefing to IDS')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar == 'Briefing to OSD')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar == 'Briefing to Designers')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to IDS')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to OSD')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to Designers')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(typeVar == 'Activity')
                                                             {
                                                                document.getElementById("noofdays").style.display = "none";
                                                             }
                                                             if(serialnum != 'AR-0302')
                                                             {
                                                                document.getElementById("complexitycategory").style.display = "none";
                                                             }
                                                             if(typeVar == 'Sub-Activity')
                                                             {
                                                                document.getElementById("complexitytype").style.display = "none";
                                                                document.getElementById("pl").style.display = "none";
                                                                document.getElementById("lead").style.display = "none";
                                                             }
                                                            

                                                          }</script>
                                                       </td>
                                                 </tr>
                                                
                                                 <!--*******************TRIAL**********************-->
                                                 <tr class="">
                                                    <td>
                                                       <h1 class="" title="Search Tool">
                                                          <apex:outputtext value="{!left(recordact.NPD_Stage__r.NPD_Stage__r.Name__c,10)}" 
                                                             style="color:Orange"> </apex:outputtext> -->
                                                          <apex:outputtext value="{!left(recordact.NPD_Stage__r.Name__c,45)}"
                                                             style="color:Orange"> </apex:outputtext>-->
                                                          <apex:outputtext value="{!left(recordact.Name__c,45)}"
                                                             style="color:Orange"></apex:outputtext>
                                                       </h1>
                                                    </td>
                                                    <td> </td>
                                                    <td> </td>
                                                    <td> </td>
                                                    <td> </td>
                                                 </tr> <!--*******************TRIAL**********************-->
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td> <label class="col-md-6"> Actual Start Date</label>
                                                    
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input Date" value="{!recordact.Actual_Start_Date__c}"
                                                          /> </div>
                                                    </td>
                                                    <td> <label class="col-md-6 "> Actual End Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input Date" value="{!recordact.Actual_End_Date__c}"
                                                          /> </div>
                                                    </td>
                                                    <td> <label class="col-md-6 "> Status</label>
                                                       <div class="col-md-6 text">
                                                          <apex:outputtext styleclass="slds-input Name" value="{!recordact.Status__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="complexitytype"> <label class="col-md-6">Complexity</label>
                                                       <div class="col-md-6 text">
                                                          <apex:inputtext styleclass="slds-input Date" value="{!record1['Complexity_Typess__c']}"
                                                             id="comType2"></apex:inputtext>
                                                          <apex:image url="{!$Resource.LookupIcon}" styleClass="lookupimg"
                                                             width="20" height="20" onclick="openComplexityTypePopup('{!$Component.comType2}','{!$Component.comCat2}','{!$Component.lead2}','{!record1['Name__c']}','{!record1['Type__c']}','{!record1['source__c']}')"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.comType2}').disabled = true;
                                                       </script>
                                                    </td>
                                                    <!--<td id="complexitycategory">
                                      <label class="col-md-6">Complexity Category</label>
                                        <div class="col-md-6 text">
                                          <apex:inputtext styleclass="slds-input Date" value="{!record1['Complexity_Category__c']}" id="comCat2"></apex:inputtext>
                                            <apex:image url="{!$Resource.LookupIcon}" styleClass="lookupimg" width="20" height="20" onclick="openComplexityPopup('{!$Component.comType2}','{!$Component.comCat2}','{!$Component.lead2}','{!record1['Name__c']}','{!record1['Type__c']}')" />
                                              </div>
                                         </td>-->   
                                                       <td style="width:10%;display:none" colspan="5" >
                                                          <input id="revAct" value="{!recordact.Revision_Active__c}"
                                                             style="color:Orange;" /> </td>
                                                    <td id="pl"> <label class="col-md-6 ">PLT</label>
                                                       <div class="col-md-6 text">
                                                          <apex:InputText styleclass="slds-input Number" id="Lead2" value="{!record1['Planned_Lead_Time__c']}"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.Lead2}').disabled = true;
                                                       </script>
                                                    </td>
                                                    <td id="lead"> <label class="col-md-6 "> LT</label>
                                                       <div class="col-md-6 text">
                                                          <apex:InputText styleclass="slds-input Number" id="ld" value="{!record1['Lead_Time__c']}"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.ld}').disabled = true;
                                                       </script>
                                                    </td>
                                                    <td id="owner" class="w100">
                                                       <div class="col-md-3">
                                                          <div class="form-group clearfix"> <label class="col-md-6">Ownership</label>
                                                             <div class="col-md-6 text">
                                                                <apex:inputField styleclass="Date" value="{!recordact.NPD_User__c}"
                                                                /> </div>
                                                          </div>
                                                       </div>
                                                    </td>
                                                    <td id="npduser"> 
                                                       <div class="col-md-3">
                                                          <div class="form-group clearfix"> <label class="col-md-6">Ownership</label>
                                                             <div class="col-md-6 text t_lookup">
                                                                <apex:inputField styleclass=" slds-input Date" value="{!recordact.NPD_User__c}"
                                                                /> </div>
                                                          </div>
                                                       </div>
                                                    </td>
                                                 </tr>
                                              </table>
                                                <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    
                                                    
                                                     <td style="width:12%;float:left;"> 
                                                       <div class="col-md-3">
                                                          <div class="form-group clearfix"> <label class="col-md-6">Approval Status</label>
                                                             <div class="col-md-6 text">
                                                                <apex:outputtext styleclass=" slds-input Date" value="{!recordact.Approval_Status__c}"
                                                                /> </div>
                                                          </div>
                                                       </div>
                                                    </td>
                                                    
                                                 <!--   <td style="width:12%;float:left;"> 
                                                       <div class="col-md-3">
                                                          <div class="form-group clearfix"> <label class="col-md-6"> Approval Required</label>
                                                             <div class="col-md-6 text ">
                                                                <apex:inputField styleclass=" slds-input" value="{!recordact.Approval_Required__c}"
                                                                /> </div>
                                                          </div>
                                                       </div>
                                                    </td>-->
                                                 </tr>
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <apex:repeat value="{!intTowrapperListforField}" var="int" id="fieldList1">
                                                       <apex:repeat value="{!intTowrapperListforField[int]}" var="field" id="fieldList1Repeat">
                                                          <td style="width:12%;float:left;">
                                                             <apex:outputPanel rendered="{!if((field.isReadonly ==false && displaydynamic==true && record1['Type__c'] =='Activity'),true,false)}">
                                                             <label class="col-md-6">
                                              <apex:outputText title="{!$ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label}"
                                                 value="{!left($ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label,15)}"></apex:outputText>
                                                 </label> 
                                                                <div class="col-md-6 text hideCurrDate">
                                                                   
                                                                   <apex:inputField styleclass="slds-input Date" value="{!record1[field.fieldAPI]}" required="{!field.isMandatory}"
                                                                   /> </div>
                                                             </apex:outputPanel>
                                                             <apex:outputPanel rendered="{!if((field.isReadonly ==true&& displaydynamic==true && record1['Type__c'] =='Activity'),true,false)}">
                                                             <label class="col-md-6 ">
                                                <apex:outputText value="{!$ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label}"></apex:outputText></label>
                                                                <div class="col-md-6 text hideCurrDate">
                                                                   <apex:outputText styleclass="slds-input Date" value="{!record1[field.fieldAPI]}"
                                                                   /> </div>
                                                             </apex:outputPanel>
                                                          </td>
                                                       </apex:repeat>
                                                    </apex:repeat>
                                                 </tr>
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td id="Revision" > <label class="col-md-6"> Revision Status</label>
                                                       <div class="col-md-6 text ">
                                                          <apex:inputField id="revisionstate" styleclass="slds-input" style="width: 123px;"
                                                             value="{!recordact.Revision_Status__c}" onchange="displayRevicionActivityDate();"
                                                          /> </div>
                                                    </td>
                                                    <td id="R1ASDdate"> <label class="col-md-6"> R1 Start Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R1_ASD__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R1AEDdate"> <label class="col-md-6"> R1 End date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R1_AED__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R2ASDdate"> <label class="col-md-6"> R2 Start Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R2_ASD__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R2AEDdate"> <label class="col-md-6"> R2 End date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R2_AED__c}"
                                                          /> </div>
                                                    </td>
                                                 </tr>
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td> <label class="col-md-6"> Comments</label>
                                                       <div class="col-md-6 text ">
                                                          <apex:inputField styleclass="slds-input" style="width: 511px;" value="{!recordact.Comments_Remarks__c}"
                                                          /> </div>
                                                    </td>
                                                 </tr>
                                              </table>
                                           </div>
                                        </div>
                                     </div>
                                  </div>
                               </apex:outputPanel>
                            </apex:outputPanel>
                            <!--End of -ActivityEditBlock PageBlock-->
                            <!--***************************************Sub-Activity Block****************************************************************************************************************************-->
                            <apex:outputPanel id="scrSubAct">
                               <apex:outputPanel rendered="{!showSubAct}" id="screensubact" style="overflow:scroll;height:50px;width:50px;">
                                <apex:pageMessages id="messagepageSubAct"  ></apex:pageMessages>
                                  <div class="slds stockit" height="100%">
                                     <div class="slds-grid slds-wrap" id="theDivId">
                                        <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                           <div class="slds-form--stacked">
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr class="">
                                                    <td> </td>
                                                    <td style="width:90%;text-align:center;"> <apex:outputPanel >
                                                   
                                      <apex:commandButton value="Save" action="{!saveActivity}"   rerender="scrSubAct,messagepageSubAct,outAct" oncomplete="hidecolactivity();" rendered="{!AND(recordact.Active__c,activityActive==true,subActive==true,stageActive==true,recordact.Approval_Status__c!='Pending')}" style="height: 29px;width: 0;padding-right: 46px;padding-left: 22px;margin-left: -491px;background-color: aliceblue;margin-top: -7px;" />
                                      
                                   
                                  </apex:outputPanel></td>
                                  
                                   <td>
                                    <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" value="Submit for Approval"    rendered="{!AND(recordact.Active__c,activityActive==true,subActive==true,stageActive==true,recordact.Approval_Required__c,(recordact.Approval_Status__c=='None'||recordact.Approval_Status__c=='Re-Submit'),recordact.Actual_Start_Date__c!=NULL)}"  oncomplete="hidecolactivity();" reRender="scrstage"    action="{!approvalitems}"   style="width: 147px;" status="actStatusId"  rerender="scrSubAct,messagepageSubAct"  />                                                        
                                    </td> 
                                  
                                  
                                                    <td style="width:10%;text-align:right;"><apex:outputPanel >
                                                     
                                                       <apex:commandLink value="Click to Activate"  rerender="scrSubAct,messagepageSubAct" oncomplete="hidecolactivity();" action="{!activateActivity}"
                                                          rendered="{!if(AND(recordact.Active__c ==false,activityActive==true,subActive==true,stageActive==true,recordact.Approval_Status__c!='Pending'),true,false)}"> </apex:commandLink>
                                                       <apex:commandLink value="Click to Deactivate" rerender="scrSubAct,messagepageSubAct" oncomplete="hidecolactivity();"
                                                          action="{!activateActivity}" rendered="{!AND(recordact.Active__c,activityActive==true,subActive==true,stageActive==true,recordact.Approval_Status__c!='Pending')}"> </apex:commandLink></apex:outputPanel>
                                                        <script>
                                                        function hidecolactivity()
                                                          {
                                                          var revisionstatus = document.getElementById('pageId:mainform:revisionstatussubact').value;
                                                          //alert('revisionstatus Sub in save '+revisionstatus );
                                                           
                                                             if(revisionActive == 'false')
                                                             {
                                                                document.getElementById("Revision").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'abc')
                                                             {
                                                                document.getElementById("R1ASDdate").style.display = "none";
                                                                document.getElementById("R1AEDdate").style.display = "none";
                                                                document.getElementById("R2ASDdate").style.display = "none";
                                                                document.getElementById("R2AEDdate").style.display = "none";
                                                             }
                                                             
                                                             if(revisionstatus == 'Activate R1')
                                                             {
                                                                document.getElementById("R1ASDdate").style.display = "";
                                                                document.getElementById("R1AEDdate").style.display = "";
                                                                document.getElementById("R2ASDdate").style.display = "none";
                                                                document.getElementById("R2AEDdate").style.display = "none";
                                                             }
                                                             if(revisionstatus == 'Activate R2')
                                                             {
                                                                document.getElementById("R1ASDdate").style.display = "";
                                                                document.getElementById("R1AEDdate").style.display = "";
                                                                document.getElementById("R2ASDdate").style.display = "";
                                                                document.getElementById("R2AEDdate").style.display = "";
                                                             }
                                                             if(revisionstatus == 'None')
                                                             {
                                                                document.getElementById("R1ASDdate").style.display = "none";
                                                                document.getElementById("R1AEDdate").style.display = "none";
                                                                document.getElementById("R2ASDdate").style.display = "none";
                                                                document.getElementById("R2AEDdate").style.display = "none";
                                                             }
                                                             
                                                             if(stageNameVar == 'Briefing to IDS')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar == 'Briefing to OSD')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar == 'Briefing to Designers')
                                                             {
                                                                document.getElementById("npduser").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to IDS')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to OSD')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(stageNameVar != 'Briefing to Designers')
                                                             {
                                                                document.getElementById("owner").style.display = "none";
                                                             }
                                                             if(typeVar == 'Activity')
                                                             {
                                                                document.getElementById("noofdays").style.display = "none";
                                                             }
                                                             if(serialnum != 'AR-0302')
                                                             {
                                                                document.getElementById("complexitycategory").style.display = "none";
                                                             }
                                                             if(typeVar == 'Sub-Activity')
                                                             {
                                                                document.getElementById("complexitytype").style.display = "none";
                                                                document.getElementById("pl").style.display = "none";
                                                                document.getElementById("lead").style.display = "none";
                                                             }
                                                             
                                                           
                                                             
                                                          }</script>   
                                                    </td>
                                                 </tr>
                                                 <tr class="">
                                                    <td>
                                                      <class="" title="Search Tool" />
                                                   
                                                      <apex:outputtext value="{!left(if(stagename1!=NULL,stagename1,record1['NPD_Stage__r.NPD_Stage__r.name__c']),10)}"
                                                          style="color:Orange"> </apex:outputtext> -->
                                                       <apex:outputtext value="{!left(if(substagename!=NULL,substagename,record1['NPD_Stage__r.name__c']),20)}"
                                                          style="color:Orange"> </apex:outputtext> -->
                                                       <apex:outputtext value="{!left(if(activityname !=NULL,activityname ,"
                                                          "),20)}" style="color:Orange"> </apex:outputtext>-->
                                                       <apex:outputtext value="{!left(record1['Name__c'],45)}"
                                                          style="color:Orange"></apex:outputtext>
                                                    </td>
                                                    <td> </td>
                                                    <td> </td>
                                                    <td> </td>
                                                    <td> </td>
                                                 </tr>
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td  style="width:10%"> <label class="col-md-6"> Actual Start Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input Date" value="{!recordact.Actual_Start_Date__c}"
                                                          /> </div>
                                                    </td>
                                                    <td  style="width:10%"> <label class="col-md-6 "> Actual End Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input Date" value="{!recordact.Actual_End_Date__c}"
                                                          /> </div>
                                                    </td>
                                                    <td  style="width:10%" > <label class="col-md-6 "> Status</label>
                                                       <div class="col-md-6 text">
                                                          <apex:outputtext styleclass="slds-input Name" value="{!recordact.Status__c}"
                                                          /> </div>
                                                    </td>
                                                  <!--  <td id="complexitytype"> <label class="col-md-6">Complexity</label>
                                                       <div class="col-md-6 text">
                                                          <apex:inputtext styleclass="slds-input Date" value="{!record1['Complexity_Typess__c']}"
                                                             id="comType3"></apex:inputtext>
                                                          <apex:image url="{!$Resource.LookupIcon}" styleClass="lookupimg"
                                                             width="20" height="20" onclick="openComplexityTypePopup('{!$Component.comType3}','{!$Component.comCat2}','{!$Component.lead3}','{!record1['Name__c']}','{!record1['Type__c']}','{!record1['source__c']}')"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.comType3}').disabled = true;
                                                       </script>
                                                    </td>
                                                    <td id="pl"> <label class="col-md-6 ">Plan LT</label>
                                                       <div class="col-md-6 text">
                                                          <apex:InputText styleclass="slds-input Number" id="Lead3" value="{!record1['Planned_Lead_Time__c']}"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.Lead3}').disabled = true;
                                                       </script>
                                                    </td>
                                                    <td id="lead"> <label class="col-md-6 "> Act LT</label>
                                                       <div class="col-md-6 text">
                                                          <apex:InputText styleclass="slds-input Number" id="ld1" value="{!record1['Lead_Time__c']}"
                                                          /> </div>
                                                       <script>
                                                       document.getElementById('{!$Component.ld1}').disabled = true;
                                                       </script>
                                                    </td>-->
                                                    <td   style="width:60%"  >
                                                        <div class="form-group clearfix"> <label class="col-md-6">Ownership</label>
                                                             <div class="col-md-6 text t_lookup">
                                                                <apex:inputField styleclass=" slds-input Date" value="{!recordact.NPD_User__c}"
                                                                /> </div>
                                                          </div>
                                                     </td>
                                                    
                                                  </tr>
                                              </table>
                                              
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                <tr>
                                                <apex:repeat value="{!intTowrapperListforField}" var="int" id="fieldList2">
                                                       <apex:repeat value="{!intTowrapperListforField[int]}" var="field" id="fieldList1Repeat2">
                                                          <td style="width:12%;float:left;">
                                                             <apex:outputPanel rendered="{!if((field.isReadonly ==false && displaydynamic==true && record1['Type__c'] =='Sub-Activity'),true,false)}">
                                                             <label class="col-md-6">                                             
                                            <apex:outputText title="{!$ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label}" value="{!left($ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label,15)}"></apex:outputText></label>
                                                                <div class="col-md-6 text t_lookup hideCurrDate">
                                                                   <!--required="{!field.isMandatory}"-->
                                                                   <apex:inputfield styleclass="slds-input Date" value="{!record1[field.fieldAPI]}"
                                                                   /> </div>
                                                             </apex:outputPanel>
                                                             <apex:outputPanel rendered="{!if((field.isReadonly ==true&& displaydynamic==true && record1['Type__c'] =='Sub-Activity'),true,false)}">
                                                             <label class="col-md-6 ">
                                             <apex:outputText value="{!$ObjectType.NPD_Activity__c.Fields[field.fieldAPI].Label}"></apex:outputText></label>
                                                                <div class="col-md-6 text t_lookup hideCurrDate">
                                                                   <apex:outputText styleclass="slds-input Date" value="{!record1[field.fieldAPI]}"
                                                                   /> </div>
                                                             </apex:outputPanel>
                                                          </td>
                                                       </apex:repeat>
                                                    </apex:repeat>
                                                 </tr>
                                               </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td id="Revision" style="width:10%"> <label class="col-md-6"> Revision Status</label>
                                                       <div class="col-md-6 text ">
                                                          <apex:inputField id="revisionstatussubact" styleclass="slds-input" style="width: 123px;"
                                                             value="{!recordact.Revision_Status__c}" onchange="displayRevicionSubActivityDate();"
                                                          /> </div>
                                                    </td>
                                                    <td id="R1ASDdate"> <label class="col-md-6"> R1 Start Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R1_ASD__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R1AEDdate"> <label class="col-md-6"> R1 End date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R1_AED__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R2ASDdate"> <label class="col-md-6"> R2 Start Date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R2_ASD__c}"
                                                          /> </div>
                                                    </td>
                                                    <td id="R2AEDdate"> <label class="col-md-6"> R2 End date</label>
                                                       <div class="col-md-6 text hideCurrDate">
                                                          <apex:inputField styleclass="slds-input date" style="width: 123px;" value="{!recordact.R2_AED__c}"
                                                          /> </div>
                                                    </td>
                                                 </tr>
                                              </table>
                                              <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 1003px; background-color: aliceblue; margin-left: -57px;">
                                                 <tr>
                                                    <td> <label class="col-md-6"> Comments</label>
                                                       <div class="col-md-6 text ">
                                                          <apex:inputField styleclass="slds-input" style="width: 511px;" value="{!recordact.Comments_Remarks__c}"
                                                          /> </div>
                                                    </td>
                                                 </tr>
                                              </table>
                                           </div>
                                        </div>
                                     </div>
                                  </div>
                               </apex:outputPanel>
                            </apex:outputPanel>
                            <!--End of -Sub-ActivityEditBlock PageBlock-->
                            <!--*****************************************************************************************************************************************************************************************-->
                            <!--******************************************Approval Activity Need to Display More  Fields***************************************************************************-->
                            <!--    <apex:outputPanel id="emailApprovalHistory">
                <apex:outputPanel id="emailApprovalHistoryin" rendered="{!isEmail}" style="overflow:scroll;height:50px;width:50px;">

                    <div class="slds NPD" height="100%" width="100%">
                        <div class="slds-grid slds-wrap" id="theDivId">
                            <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                <div class="slds-form--stacked">
                                    <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 930px; background-color: aliceblue;">
                                       
                                        <tr>
                                            
                                        </tr>
                                        
                                        <tr>
                                            <td>
                                                <apex:commandlink value="Send Email" style="color:blue;" action="{!sendEmail}" rerender="sendemail" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>

                                                <div>
                                                    <label> <b>Parent ID</b></label>
                                                </div>
                                            </td>
                                           
                                           
                                        </tr>

                                        <apex:variable value="{!0}" var="row" />
                                        <apex:repeat value="{!emailList }" var="approval">
                                            <tr>
                                                <td>

                                                    <div class="col-md-6 text" style="width: 150px;">
                                                        <apex:outputtext styleclass="slds-input" style="width: 101px;" value="{!approval.ParentId }"  />
                                                    </div>
                                                </td>

                                              </tr>

                                        </apex:repeat>

                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>-->
                            <!--*************************************************************************************************************************************************************************-->
                         </div>
                         <!--****************ACTION FUNTIONS**********************************************************-->
                         
                         <apex:actionFunction name="actionFunforApproval"  action="{!approvalitems}"   status="actStatusId">
                         <apex:param name="event" value="view" assignTo="{!event}" />
                         </apex:actionFunction>
                         
                         
                        
                         
                         <apex:actionFunction name="showActivityList" reRender="outAct,attpanal11,messagesall,attachform,outstage,activitytask,activityApprovalHistory,Successor,activitynote,theForm,scrstage,scract,scrSubAct,buttonform,dynamicTable,dynamicTableData,attpanalstage,dynamicTableData,dynamicTable" oncomplete="displaymainform();"
                            action="{!displayStageActivity}">
                            <apex:param value="edit" name="stgid" assignto="{!strActionId}" />
                            <apex:param value="name" name="stgname" assignto="{!strActionname}" /> </apex:actionFunction>
                         <apex:actionFunction name="setselectedType" rerender="xxx" action="{!dummy}">
                            <apex:param value="" name="myPicklistElement" assignto="{!selectedType}" />
                            <apex:param value="" name="modelNum" assignto="{!modelNum}" /> </apex:actionFunction>
                         <apex:actionFunction name="SaveStageAction" action="{!saveIndividualTask}"
                            rerender="activitynote" status="actStatusId">
                            <apex:param value="" name="row" assignto="{!rowNum}" />
                            <apex:param value="" name="recType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                       
                            
                         <apex:actionFunction name="cancelStageAction" action="{!cancelTask}" id="cancelactionid"
                            rerender="activitytask,activitynote" oncomplete="" immediate="true" status="actStatusId">
                            <apex:param value="" name="rowNum" assignto="{!rowNum}" />
                            <apex:param value="" name="relatedListType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                         <apex:actionFunction name="editStageAction" action="{!edittask}" id="editactionid" oncomplete=""
                            rerender="pageId,buttonbodyform,activitytask,activitytaskin,activitynote" status="actStatusId">
                            <apex:param value="" name="rowNum" assignto="{!rowNum}" />,
                            <apex:param value="" name="relatedListType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                            
                        
                            
                         <apex:actionFunction name="deleteStageAction" action="{!deletetask}" id="deleteactionid"
                            rerender="activitytask,activitynote,attpanal11,CheckId,dynamicTable,attpanalstage" oncomplete="" status="actStatusId">
                            <apex:param value="" name="rowNum" assignto="{!rowNum}" />
                            <apex:param value="" name="relatedListType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                             <apex:actionFunction name="editMyStageAction" action="{!editTask}" id="editmyAll"
                            rerender="activitytask,activitynote,attpanal11,CheckId,dynamicTable,attpanalstage" oncomplete="" status="actStatusId">
                            <apex:param value="" name="rowNum" assignto="{!rowNum}" />
                            <apex:param value="" name="relatedListType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                         <apex:actionFunction name="displaymodelinfoaction" rerender="panel2" oncomplete="hidemainform();"
                            action="{!displaymodel}">
                            <apex:param value="" name="modelNum" assignto="{!modelNum}" />
                            <apex:param value="" name="stgid" assignto="{!strActionId}" />
                            <apex:param value="" name="stgname" assignto="{!strActionname}" /> </apex:actionFunction>
                         <script>
                         function showimage()
                         {
                            var et = document.getElementsByClassName("popup21")
                            et[0].style.display = "block";
                         }

                         function hideimage()
                         {
                            var et = document.getElementsByClassName("popup21")
                            et[0].style.display = "none";
                         }

                         function displaymodelinfo()
                         {
                            var modelNum = document.getElementById('pageId:theForm:modlenum').value;
                            // alert(modelNum);
                            displaymodelinfoaction(modelNum);
                         }
                         </script>
                      </div>
                   </div>
                </fieldset>
             </div>
          </div>
          <!--****************JAVA SCRIPT**********************************************************-->
           <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
       
      
           
          <script>
           
           $( document ).ready(function() {
            var revisionActivestageload = document.getElementById('revActstage').value;
            var namestageoad = document.getElementById('namestage').value;
            var typestageoad = document.getElementById('typestage').value;
            
            //alert('revisionActiveonload '+revisionActive);
            //alert('namestage namestage '+namestage);
            //alert('typestageoad'+typestageoad );
            
            
            
            
           if(revisionActivestageload == 'false') {
          // alert('revisionActivestageload ');
              document.getElementById("Revision").style.display = "none";
           }
           if(namestageoad != 'abc') {
           //alert(namestageoad );
              document.getElementById("R1ASDdate").style.display = "none";
              document.getElementById("R1AEDdate").style.display = "none";
              document.getElementById("R2ASDdate").style.display = "none";
              document.getElementById("R2AEDdate").style.display = "none";
           }
           if(namestageoad != 'Case Development - INH') {
              document.getElementById("ComplexityCategory").style.display = "none";
           }
           if(typestageoad == 'Stage') {
              document.getElementById("complexity").style.display = "none";
           }
           if(namestageoad != 'Marketing Brief/Concept') {
              //alert('stageNameVar '+stageNameVar );
              document.getElementById("dsnmanager").style.display = "none";
           }
           if(namestageoad == 'Concept Design - IDS') {
              //alert('heloohelooheloohelooheloo');
              document.getElementById("actcol").style.display = "";
           }
        
             });
         
            
            </script> 
            
              <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
            
            <script>
           
           $( document ).ready(function() {
            hideColact();
             });
         
            
            </script>
            
              <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
            
            <script>
           
           $( document ).ready(function() {
            displayRevicionSubActivityDate();
             });
         
            
            </script>
            
          
          <script>
          var revisionsubActive = '';
          var stageNameVar = '';
          var typeVar = '';
          var serialnum = '';
          var previousButtonId = 'nocolor';
          var revisionActive = document.getElementById('revAct').value;
         
            function callApprovalProcess(){
               var r = confirm("Record will not able to edit after sending it to Approval Process.\nAre you sure want to send for Approval Process?");
               if(r == true) {
                  actionFunforApproval();
               }
            }
            
          function loaderEnable(){
            document.getElementById('preloader').style.display = "";
            }
            function loaderUnable(){
                document.getElementById('preloader').style.display = "none";
            }
          
           function savestagevalue(){
          //alert('render');
           savestagevaluestg();
           }

          function showActivity(stgid, stgname, cls)
          {
             console.log('previousButtonId : ' + previousButtonId);
             if(previousButtonId != 'nocolor')
             {
                document.getElementById('Button1' + previousButtonId).style.backgroundColor = "#4ca64c";
             }
             console.log('showActivity : ' + stgname);
             document.getElementById('Button1' + cls).style.backgroundColor = "rgba(204, 0, 0, 0.75)";
             showActivityList(stgid, stgname);
             previousButtonId = cls;
          }

          function PicklistChanged()
          {
             var myPicklistElement = document.getElementById('pageId:theForm:myPicklist').value;
             setselectedType(myPicklistElement);
             //alert('Please search and click on ModelNo');
          }

          function showstName(stgname, type, id, revsubActive)
          {
             
             
             showStageScreen(stgname, type, id);
             stageNameVar = stgname;
             typeVar = type;
             revisionsubActive = revsubActive;
          }

          function showActName(stgname, type, id, revisionactive)
          {
             // alert('serialnum serialnum '+revisionactive);
             showActivityScreen(stgname, type, id);
             stageNameVar = stgname;
             typeVar = type;
             serialnum = serialnum;
             revisionActive = revisionactive;
          }

          function saveActivitycall()
          {
             saveActivitycontroller();
          }

          function hidemainform()
          {
             document.getElementById("pageId:mainform").style.display = "none";
             document.getElementById("pageId:buttonbodyform").style.display = "none";
             document.getElementById("pageId:buttonform").style.display = "none";
             document.getElementById("pageId:attachform").style.display = "none";
             //document.getElementById("pageId:sendemailform").style.display = "none";
          }

          function displaymainform()
          {
             document.getElementById("pageId:mainform").style.display = "";
             document.getElementById("pageId:buttonbodyform").style.display = "";
             document.getElementById("pageId:buttonform").style.display = "";
             document.getElementById("pageId:attachform").style.display = "";
              document.getElementById("pageId:buttonbodyform:activitytask").style.display = "";
               document.getElementById("pageId:activitynote").style.display = "";
                document.getElementById("pageId:activityApprovalHistory").style.display = "";
                 document.getElementById("pageId:Successor").style.display = "";
             document.getElementById("pageId:buttonbodyform:ActivityViewEditBlock").style.display = "";
             //document.getElementById("pageId:sendemailform").style.display = "";
             
          }

          function hideCol() {
         //alert('stage'+stageNameVar);
         //alert('revisionActiveonstagehide '+revisionActive );
           if(revisionsubActive == 'false') {
          // alert('ifififi');
              document.getElementById("Revision").style.display = "none";
           }
           if(stageNameVar != 'abc') {
           //alert('ifififielse');
              document.getElementById("R1ASDdate").style.display = "none";
              document.getElementById("R1AEDdate").style.display = "none";
              document.getElementById("R2ASDdate").style.display = "none";
              document.getElementById("R2AEDdate").style.display = "none";
           }
           if(stageNameVar != 'Case Development - INH') {
              document.getElementById("ComplexityCategory").style.display = "none";
           }
           if(typeVar == 'Stage') {
              document.getElementById("complexity").style.display = "none";
           }
           if(stageNameVar != 'Marketing Brief/Concept') {
              //alert('stageNameVar '+stageNameVar );
              document.getElementById("dsnmanager").style.display = "none";
           }
           if(stageNameVar == 'Concept Design - IDS') {
              //alert('heloohelooheloohelooheloo');
              document.getElementById("actcol").style.display = "";
           }
        }






          function hideColact()    
          {
            // alert('outoutrevisionActive '+revisionActive );
             if(revisionActive == 'false')
             {
               // alert('revisionActivefalse '+revisionActive );
                document.getElementById("Revision").style.display = "none";
             }
             
            
             if(stageNameVar != 'abc')
             {
                //alert('stageNameVar '+stageNameVar );
               
                document.getElementById("R1ASDdate").style.display = "none";
                document.getElementById("R1AEDdate").style.display = "none";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
             if(stageNameVar == 'Briefing to IDS')
             {
                document.getElementById("npduser").style.display = "none";
             }
             if(stageNameVar == 'Briefing to OSD')
             {
                document.getElementById("npduser").style.display = "none";
             }
             if(stageNameVar == 'Briefing to Designers')
             {
                document.getElementById("npduser").style.display = "none";
             }
             if(stageNameVar != 'Briefing to IDS')
             {
                document.getElementById("owner").style.display = "none";
             }
             if(stageNameVar != 'Briefing to OSD')
             {
                document.getElementById("owner").style.display = "none";
             }
             if(stageNameVar != 'Briefing to Designers')
             {
                document.getElementById("owner").style.display = "none";
             }
             if(typeVar == 'Activity')
             {
                document.getElementById("noofdays").style.display = "none";
             }
             if(serialnum != 'AR-0302')
             {
                document.getElementById("complexitycategory").style.display = "none";
             }
             if(typeVar == 'Sub-Activity')
             {
                document.getElementById("complexitytype").style.display = "none";
                document.getElementById("pl").style.display = "none";
                document.getElementById("lead").style.display = "none";
             }
             
            
          }
          
          
        
          //Function to show Revision date
          function displayRevicionActivityDate()
          {
             var revisionstatus = document.getElementById('pageId:mainform:revisionstate').value;
             if(revisionstatus == 'Activate R1')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
             if(revisionstatus == 'Activate R2')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "";
                document.getElementById("R2AEDdate").style.display = "";
             }
             if(revisionstatus == 'None')
             {
                document.getElementById("R1ASDdate").style.display = "none";
                document.getElementById("R1AEDdate").style.display = "none";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
          }
          //Function to show Revision date
          function displayRevicionSubActivityDate()
          {
             var revisionstatus = document.getElementById('pageId:mainform:revisionstatussubact').value;
             //alert('displayRevicionSubActivityDate calll revisionstatus '+revisionstatus );
             if(revisionstatus == 'Activate R1')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
             if(revisionstatus == 'Activate R2')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "";
                document.getElementById("R2AEDdate").style.display = "";
             }
             if(revisionstatus == 'None')
             {
                document.getElementById("R1ASDdate").style.display = "none";
                document.getElementById("R1AEDdate").style.display = "none";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
          }

          function displayRevicionSubstageDate(revid)
          {
             var revisionstatus = document.getElementById(revid).value;
             if(revisionstatus == 'Activate R1')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
             if(revisionstatus == 'Activate R2')
             {
                document.getElementById("R1ASDdate").style.display = "";
                document.getElementById("R1AEDdate").style.display = "";
                document.getElementById("R2ASDdate").style.display = "";
                document.getElementById("R2AEDdate").style.display = "";
             }
             if(revisionstatus == 'None')
             {
                document.getElementById("R1ASDdate").style.display = "none";
                document.getElementById("R1AEDdate").style.display = "none";
                document.getElementById("R2ASDdate").style.display = "none";
                document.getElementById("R2AEDdate").style.display = "none";
             }
          }

          function openComplexityTypePopup(comTyp, comCat, leadtime, title, type, source)
          {
             var url = "/apex/NPD_Complexity_Type_Popup?" + "&comType=" + comTyp + "&comCat=" + comCat + "&leadtime=" +
                leadtime + "&title=" + title + "&type=" + type + "&source=" + source;
             newWin = window.open(url, 'Popup4',
                'height=400,width=300,left=100,top=50,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if(window.focus)
             {
                newWin.focus();
             }
             return false;
          }

          function openComplexityPopup(comTyp, comCat, leadtime, title, type)
          {
             var compString = document.getElementById(comTyp).value;
             var url = "/apex/NPD_Complexity_Popup?" + "&comType=" + compString + "&comCat=" + comCat + "&leadtime=" +
                leadtime + "&title=" + title + "&type=" + type;
             newWin = window.open(url, 'Popup3',
                'height=400,width=300,left=100,top=50,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if(window.focus)
             {
                newWin.focus();
             }
             return false;
          }

          function closeComplexitypopup()
          {
             if(null != newWin)
             {
                newWin.close();
             }
          }

          function closemypopup(idd)
          {
             //var id1=idd;
             //var x=id1.lastIndexOf(":");
             //var y=id1.substring(0,x);
             document.getElementById(idd).style.display = "none";
          }

          function OpenBrandPopup1(BrandComponent)
          {
             var url = "/apex/NPD_Brand_Popup?" + "&BrandComponent=" + BrandComponent;
             newWin = window.open(url, 'Popup3',
                'height=400,width=300,left=100,top=50,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if(window.focus)
             {
                newWin.focus();
             }
             return false;
          }
          <!--Save Dynamic table data-->
           function saveDynamicTableData(row, recType)
          {
             saveDynamicAction(row, recType);
          }
          <!--Save Activity Task-->
          function saveStageTask(row, recType)
          {
             SaveStageAction(row, recType);
          }
          <!--remove row Activity Task-->
          function cancelStageTask(row, recType)
          {
             var r1 = confirm("You want to Cancel this record update ? ");
             if(r1 == true)
             {
                cancelStageAction(row, recType);
             }
          }
          <!--Edit Activity Task-->
          function editStageTask(row,recType)
          {
             alert('*************ROWNUM***'+row);
             editStageAction(row,recType);
          }
          <!-- edit dynamic table records -->
          function editDynamicRecord(row,recType)
          {
             alert('*************ROWNUM***'+row);
             editDynamicAction(row,recType);
          }
          function EditMyStageTask(row, recType)
          {
             var r1 = confirm("You want to edit this record ? ");
             if(r1 == true)
             {
                editMyStageAction(row, recType);
             }
          }

          function deleteStageTask(row, recType)
          {
             var r1 = confirm("You want to delete this record ? ");
             if(r1 == true)
             {
                deleteStageAction(row, recType);
             }
          }
          
          //Download of attachment
          function downLoadAttac(attId) {
         // alert(attId);
                var urlAtt = '/servlet/servlet.FileDownload?file='+attId;
                window.open(urlAtt, 'Popup6','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
            }
            
       
          
          
          
          </script>
          <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
          <script>
          $(function()
          {
             $('#pageId:mainform:thedate').datepicker(
             {
                dateFormat: 'dd-mm-yy',
                altFormat: 'yy-mm-dd'
             });
          });
          </script>
          <!--************************************************************************************************************************************************************-->
       </apex:form>
       <apex:form id="buttonform">
          <apex:outputPanel id="dynamicTableData">
             <apex:outputPanel rendered="{!AND(showActscreenbutton,recordact.Approval_Status__c!='Pending')}" id="screenact12" styleClass="btn_outer_line" style="overflow:scroll;height:50px;width:50px;">
             <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: 322px; margin-top: -22px;"
                   value="Variant Info" action="{!viewDynamicTable}" rerender="activityApprovalHistory,messagepage,messagepageAct,messagepageSubAct,activitynote,activitytask,attpanal1,attpanal11,sendemail,EmaillHistory,Successor,dynamicTable,"
                   status="actStatusId" />
                <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style=" margin-top: -22px;"
                   value="Attachment" action="{!viewattachment}" rerender="activityApprovalHistory,messagepage,messagepageAct,messagepageSubAct,activitynote,activitytask,attpanal1,attpanal11,sendemail,EmaillHistory,Successor,dynamicTable"
                   status="actStatusId" />
                <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: -1px; margin-top: -22px; "
                   value="Task" action="{!viewTask}" rerender="activityApprovalHistory,messagepage,messagepageAct,messagepageSubAct,activitynote,activitytask,attpanal11,attachform,sendemail,EmaillHistory,Successor,dynamicTable"
                   status="actStatusId" />
                <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: -1px; margin-top: -22px;"
                   value="Notes" action="{!viewNote}" rerender="activityApprovalHistory,messagepage,messagepageAct,messagepageSubAct,activitytask,activitynote,attpanal11,attachform,sendemail,EmaillHistory,Successor,dynamicTable"
                   status="actStatusId" />
                <!-- <apex:actionRegion >
                        <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: -1px; margin-top: -22px;" value="Email" action="{!viewEmail}" rerender="EmaillHistory,sendemail,activityApprovalHistory,activityApprovalHistory,activitytask,activitynote,attpanal11,attachform,Successor" status="actStatusId" immediate="true" />
                        </apex:actionRegion> -->
                <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: -1px; margin-top: -22px;"
                   value="Approval History" action="{!viewActivityApprovalHistorylist}" rerender="activityApprovalHistory,messagepage,messagepageAct,messagepageSubAct,activitytask,activitynote,attpanal11,attachform,sendemail,EmaillHistory,Successor,dynamicTable"
                   status="actStatusId" />
                <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected" style="margin-left: -1px; margin-top: -22px;"
                   value="Successor" action="{!Successorlist}" rerender="activityApprovalHistory,messagepageAct,messagepage,messagepageSubAct,activitytask,activitynote,attpanal11,attachform,sendemail,EmaillHistory,Successor,dynamicTable"
                   status="actStatusId" /> </apex:outputPanel>
          </apex:outputPanel>
         </apex:form>
         
   <!--      <script>
         function hideMessage(){
             alert('Hi');
              document.getElementById('pageId.messagepageAct').style.display = "block";
         }
         </script>  -->
      
       <!--******************************************************dynamic Table********************************************************************************************************-->
         
        <apex:form id="buttonbodyform" styleClass="widthdynamiclarge" >
                        <apex:actionregion >
         <apex:actionFunction name="saveDynamicAction" action="{!savedynamictable}"
                            rerender="CheckId,dynamicTable" status="actStatusId">
                            <apex:param value="" name="row" assignto="{!rowNum}" />
                            <apex:param value="" name="recType" assignTo="{!relatedListType}" /> </apex:actionFunction>
                            
         <apex:actionFunction name="editDynamicAction" action="{!editdynamictable}" id="editactionid123" oncomplete=""
                            rerender="CheckId,dynamicTable" status="actStatusId">
                            <apex:param value="" name="rowNum" assignto="{!rowNum}" />
                            <apex:param value="" name="relatedListType" assignTo="{!relatedListType}" /> 
        </apex:actionFunction>
                   <apex:outputPanel id="dynamicTable" styleClass="ScrollStyleDynamic">
                  <apex:outputPanel rendered="{!ischklist}" id="dynamictab" >
                    <apex:pageBlock id="ActivityViewEditBlock" >
                      <apex:pageblocksection title="Variant Info" columns="1" id="CheckId" onKeyPress="return disableEnterKey(event)">
                            <apex:outputPanel id="EditButOutPanelActId">
                                        <apex:commandLink value="Add More"   action="{!createCheckList}" style="color:blue;" rerender="CheckId,dynamicTable" status="actStatusId" /> &nbsp;&nbsp;
                                        <apex:commandLink value="Save"    action="{!savedynamictable}" style="color:blue;" rerender="CheckId,dynamicTable" status="actStatusId" />&nbsp;&nbsp;
                                         <apex:commandLink value="Edit"    action="{!editdynamictable}" style="color:blue;" rerender="CheckId,dynamicTable"  status="actStatusId"/>&nbsp;&nbsp;
                                         <apex:commandLink value="Cancel"    action="{!canceldynamic}" style="color:blue;" rerender="CheckId,dynamicTable" status="actStatusId" />
                           </apex:outputPanel>
                           
                        <apex:variable value="{!0}" var="row1" />
                        <apex:pageBlockTable value="{!dynamicSobjWrapperMap['NPD_Checklist__c']}" var="wrapCheck" rendered="{!IsCheckLists}" >
                         <apex:outputPanel id="EditButOutPanelActId">
                        <apex:commandLink value="Savebutton"    action="{!savedynamictable}" style="color:blue;"/>
                         </apex:outputPanel>
                          <apex:repeat value="{!DisplayFieldsList}" var="key">
                            <!--<apex:column headerValue="{!$ObjectType.NPD_Checklist__c.Fields[key].Label}">
                                  <apex:outputField value="{!wrapCheck.sobj[key]}" rendered="{!if(isdynamicedit=true,false,true)}" 
                              />
                              <apex:inputfield value="{!wrapCheck.sobj[key]}" rendered="{!if(isdynamicedit=true,true,false)}"  
                              /> </apex:column>-->
                              
                              <apex:column headerValue="{!$ObjectType.NPD_Checklist__c.Fields[key].Label}"  style="width:70px !important; background-color: aliceblue;">
                                                <apex:outputField value="{!wrapCheck.sobj[key]}" rendered="{!(NOT(wrapCheck.isedit))}" style="width:60px !important" />
                                                <apex:inputfield value="{!wrapCheck.sobj[key]}"  rendered="{!((wrapCheck.isedit) && (($ObjectType.NPD_Checklist__c.Fields[key].Label != 'Design No'  && $ObjectType.NPD_Checklist__c.Fields[key].Label != 'Approval Status') || activityNameDY == 'Make or Buy and Model No. Allocation'))}"  style="width:60px !important" />
                                            </apex:column>
                          </apex:repeat>
                          
                          <apex:column headervalue="Action" style="width:60px !important; color:blue;cursor:pointer; background-color: aliceblue;" >
                         <u>  <apex:outputlabel value="Edit" onClick="editDynamicRecord('{!row1}','NPD_Checklist__c');"  style="color:blue;cursor:pointer;"  rendered="{!NOT(wrapCheck.isedit)}" /></u>
                        <u>  <apex:outputlabel value="Save"  onclick="saveDynamicTableData('{!row1}','NPD_Checklist__c');"  style="color:blue;cursor:pointer;"  rendered="{!(wrapCheck.isedit)}" />                     
                          </u><apex:outputtext value=" | "/>
                        <u><apex:outputlabel value="Del"  onClick="deleteStageTask('{!row1}','NPD_Checklist__c');" style="width:60px !important; color:blue;cursor:pointer; background-color: aliceblue;"/></u>
                          
                            <apex:variable value="{!row1+1}" var="row1" /> </apex:column> 
                        </apex:pageBlockTable>
                      </apex:pageblocksection>
                    </apex:pageBlock>
                  </apex:outputpanel>
                </apex:outputpanel>
                     </apex:actionregion>

          <!--****************************************Stage Attachment*********************************************************************************************-->
         
         
         
          <apex:outputPanel id="attpanalstage" >
           
             <apex:outputPanel id="attstage" rendered="{!AND(isAttachStage,selectedType='Stage',stagename='Marketing Brief/Concept')}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                         
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="{!if(selectedType='Stage',"width: 933px;background-color: aliceblue;margin-left: 308px;margin-top: -23px;","width: 76%;background-color: aliceblue;margi;float: right;")}">
                               <tr>
                                  <td>
                                     <apex:commandlink value="Add Attachment" style="color:blue;"  action="{!createAttachment}" rerender="attachform"
                                        immediate="true" status="actStatusId"/> </td>
                               </tr>
                               <tr>
                                  <td>
                                     <div> <label> <b>Title </b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Description</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Body</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Related To</b></label> </div>
                                  </td>
                               </tr>
                               <apex:variable value="{!0}" var="row" />
                               <apex:repeat value="{!attWrapperStageList }" var="attwrap">
                                  <tr>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputField styleclass="slds-input" value="{!attwrap.ate['name']}" /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputField styleclass="slds-input" value="{!attwrap.ate['Description']}" /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:variable value="{!attwrap.ate['id']}" var="attachId" /> <u><apex:outputlabel value="View File" rendered="{!NOT(attwrap.isedit)}" style="cursor:pointer;" onClick="downLoadAttac('{!attachId}');"/> </u>                                       </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;"> {!attparentname} </div>
                                     </td>
                                     <td>
                                        <apex:outputlabel value="Del" onClick="deleteStageTask('{!row}','Attachment');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(attwrap.isedit)}" />
                                        <apex:variable value="{!row+1}" var="row" /> </td>
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          
          <!--****************************************Activity Attachment*********************************************************************************************-->
          <apex:outputPanel id="attpanal11">
             <apex:outputPanel id="att" rendered="{!AND(isAttach,OR(selectedType='Activity' || selectedType='Sub-Activity'))}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                         
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="{!if(selectedType='Stage',"width: 933px;background-color: aliceblue;margin-left: 267px;margin-top: -23px;","width: 76%;background-color: aliceblue;margi;float: right;")}">
                               <tr>
                                  <td>
                                     <apex:commandlink value="Add Attachment" style="color:blue;"  action="{!createAttachment}" rerender="attachform"
                                        immediate="true" status="actStatusId"/> </td>
                               </tr>
                               <tr>
                                  <td>
                                     <div> <label> <b>Title </b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Description</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Body</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Related To</b></label> </div>
                                  </td>
                               </tr>
                               <apex:variable value="{!0}" var="row" />
                               <apex:repeat value="{!attWrapperStageList }" var="attwrap">
                                  <tr>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputField styleclass="slds-input" value="{!attwrap.ate['name']}" /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputField styleclass="slds-input" value="{!attwrap.ate['Description']}" /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:variable value="{!attwrap.ate['id']}" var="attachId" /> <u><apex:outputlabel value="View File" rendered="{!NOT(attwrap.isedit)}" style="cursor:pointer;" onClick="downLoadAttac('{!attachId}');"/> </u>                                       </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;"> {!attparentname} </div>
                                     </td>
                                     <td>
                                        <apex:outputlabel value="Del" onClick="deleteStageTask('{!row}','Attachment');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(attwrap.isedit)}" />
                                        <apex:variable value="{!row+1}" var="row" /> </td>
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          
          <!--******************************************TASK Activity***************************************************************************-->
          <apex:outputPanel id="activitytask">
             <apex:outputPanel id="activitytaskin" rendered="{!istask}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                               <tr>
                                  <td>
                                     <apex:commandlink value="Add Task" style="color:blue;" action="{!createTask}" rerender="activitytaskcreated" status="actStatusId"
                                       immediate="true" 
                                     /> </td>
                               </tr>
                               <tr>
                                  <td>
                                     <div> <label> <b>Subject</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Status</b></label> </div>
                                  </td>
                                  <!-- <td>
                                                                        <div>
                                                                            <label> <b>Cstm/S.FUser</b></label>
                                                                        </div>
                                                                    </td>-->
                                  <td>
                                     <div> <label> <b>PriorityTo</b></label> </div>
                                  </td>
                                   <td>
                                     <div> <label> <b>Assignee Name</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>ActivityDate</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Comments</b></label> </div>
                                  </td>
                                  <td>
                                  </td>
                               </tr>
                               <apex:variable value="{!0}" var="row" />
                               <apex:repeat value="{!taskWrapperStageList}" var="taskWrap">
                                  <tr>
                                     <td>
                                        <div class="col-md-6 text" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!taskWrap.tsk.Subject}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                         </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!taskWrap.tsk.Status}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                           </div>
                                     </td>
                             
                                     <td>
                                        <div class="col-md-6 text" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!taskWrap.tsk.Priority}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                        </div>
                                     </td>
                                        <td>
                                        <div class="col-md-6 text" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!taskWrap.tsk.tempuser__c}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                        </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text hideCurrDate" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 80px;" value="{!taskWrap.tsk.ActivityDate}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                           </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 95px;">
                                           <apex:outputField styleclass="slds-input" style="width: 80px;" value="{!taskWrap.tsk.Description}"
                                              rendered="{!NOT(taskWrap.isedit)}" />
                                           </div>
                                     </td>
                                     <td>
                                   <!--     <apex:outputlabel value="Edit" onClick="EditMyStageTask('{!row}','Task');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(taskWrap.isedit)}" />
                                        <apex:outputlabel value="Save" onclick="saveStageTask('{!row}','Task')" style="color:blue;cursor:pointer;"
                                           rendered="{!(taskWrap.isedit)}" /> 
                                        <apex:outputtext value=" | " rendered="{!NOT(taskWrap.isedit)}"  />   -->
                                        <apex:outputlabel value="Del" onClick="deleteStageTask('{!row}','Task');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(taskWrap.isedit)}" />
                                 <!--       <apex:outputlabel value="Cancel" onClick="cancelStageTask('{!row}','Task');" style="color:blue;cursor:pointer;"
                                           rendered="{!(taskWrap.isedit)}" />  -->
                                        <apex:variable value="{!row+1}" var="row" /> </td>
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          
          
          
            <apex:outputPanel id="activitytaskcreated">
             <apex:outputPanel id="activitytaskincreated" rendered="{!isTaskCreated}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                           
                                  <tr>
                                     <td style="width: 5px;">
                                         <apex:inputfield value="{!tsk.Subject}" style="width: 130px;"/> 
                                     </td>
                                     <td style="width: 5px;">
                                        <apex:inputfield value="{!tsk.Status}" style="width: 120px;"/>
                                     </td>
                             
                                     <td style="width: 5px;">
                                         <apex:inputfield value="{!tsk.Priority}" style="width: 110px;"/>
                                     </td>
                                      <td style="width: 10px;">
                                         <apex:inputfield value="{!tsk.tempuser__c}" id="usr">
                                         <apex:image url="{!$Resource.LookupIcon}" width="20" height="20" onclick="popupforassigntask('{!$Component.usr}')"/>
                                         </apex:inputfield>
                                     </td>
                                     <td style="width: 15px;">
                                       <div class="col-md-6 text hideCurrDate">
                                          <apex:inputfield value="{!tsk.ActivityDate}" />
                                       </div>
                                     </td>
                                     <td style="width: 15px;">
                                           <apex:inputfield value="{!tsk.Description}" />
                                     </td>
                                     <td style="width: 15px;">
                                      <apex:commandButton value="Save" action="{!savetask}" rerender="buttonform,activitytaskcreated,activitytask,activitynote" style="color:blue;cursor:pointer;" status="actStatusId"/>
                                     <apex:commandButton value="cancel" action="{!cancelTask}" rerender="buttonform,activitytaskincreated,activitytaskcreated,activitytask,activitynote" immediate="true" style="color:blue;cursor:pointer;" status="actStatusId"/>

                                      </td>
                                  </tr>
                             
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          <!--*************************************************************************************************************************************************************************-->
          <!--******************************************NOTE Activity***************************************************************************-->
          <!--*************************************************************************************************************************************************************************-->
          <apex:outputPanel id="activitynote">
             <apex:outputPanel id="activitynotein" rendered="{!isNote}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                               <tr>
                                  <td>
                                     <apex:commandlink value="Add Notes" style="color:blue;" action="{!createNote}" rerender="activitynoteinput" status="actStatusId"
                                        immediate="true"   /> </td>
                               </tr>
                               <tr>
                                  <td>
                                     <div> <label> <b>Title</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Body</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Related To</b></label> </div>
                                  </td>
                               </tr>
                               
                                <apex:variable value="{!0}" var="row" /> 
                               <apex:repeat value="{!noteWrapperStageList}" var="note">
                              
                                  <tr>
                                     <td>
                                     
                                        <apex:outputfield value="{!note.nte['title']}" rendered="{!NOT(note.isedit)}" />
                                        </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputfield value="{!note.nte['body']}" rendered="{!NOT(note.isedit)}" />
                                          </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputfield value="{!recordact.Name__c}" rendered="{!NOT(note.isedit)}" />
                                          </div>
                                     </td>
                                     
                                     <td>
                                <!--      <apex:outputlabel value="Edit" onClick="EditMyStageTask('{!row}','Note');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(note.isedit)}" />
                                            <apex:outputlabel value="|"
                                           rendered="{!NOT(note.isedit)}" />  -->
                                    
                                        <apex:outputlabel value="Del" onClick="deleteStageTask('{!row}','Note');" style="color:blue;cursor:pointer;"
                                           rendered="{!NOT(note.isedit)}" />
                                       
                                        <apex:variable value="{!row+1}" var="row" /> </td>
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          
          
          
             <apex:outputPanel id="activitynoteinput">
             <apex:outputPanel id="activitynoteinputdup" rendered="{!isNoteCreated}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                              
                                    <tr>
                                     <td>
                                     
                                        <apex:inputtext value="{!nte.title}" /> </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:inputtext value="{!nte.body}" /> </div>
                                     </td>
                                     <td> <!-- {!attparentname} -->
                                        <div class="col-md-6 text" style="width: 150px;">{!recordact.Name__c}</div>
                                     </td>
                                     <td>
                                     <apex:commandButton value="Save" action="{!saveNote}" rerender="buttonform,activitynoteinput,activitynoteinputdup,activitynote,activitynotein" style="color:blue;cursor:pointer;" status="actStatusId"/>
                                     <apex:commandButton value="cancel" action="{!viewNote}" rerender="buttonform,activitynoteinput,activitynoteinputdup,activitynote,activitynotein" style="color:blue;cursor:pointer;" status="actStatusId"/>

                                   </td>
                                  </tr>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          <!--******************************************Approval Activity Need to Display More  Fields***************************************************************************-->
          <apex:outputPanel id="activityApprovalHistory">
             <apex:outputPanel id="activityapprovalhistoryin" rendered="{!isapproval}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                               <tr>
                                  <td>
                                     <div> <label> <b>Status</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>ActivityDate</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Comments</b></label> </div>
                                  </td>
                               </tr>
                               <apex:variable value="{!0}" var="row" />
                               <apex:repeat value="{!approvalhislist }" var="approval">
                                  <tr>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputtext styleclass="slds-input" style="width: 101px;" value="{!approval.ProcessInstance.Status}"
                                           />
                                           <apex:Inputtext styleclass="slds-input" style="width: 101px;" value="{!approval.ProcessInstance.Status}"
                                           /> </div>
                                     </td>
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          <!--*************************************************************************************************************************************************************************-->
          <!--*************************************************Email History****************************************************************************
                                    
                                    
                                     <apex:outputPanel id="EmaillHistory">
                                        <apex:outputPanel id="emailhistoryin" rendered="{!isEmail}" style="overflow:scroll;height:50px;width:50px;">

                                            <div class="slds NPD" height="100%" width="100%">
                                                <div class="slds-grid slds-wrap" id="theDivId">
                                                    <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                        <div class="slds-form--stacked">
                                                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 900px; background-color: aliceblue; margin-left: 315px; margin-top:  9px;">
                                                                
                                                                 <tr>
                                                                    <td>
                                                                    <!--<apex:actionRegion >
                                                                        <apex:commandlink value="SendMail" style="color:blue;"   action="{!sendEmail}" rerender="sendemail"  immediate="true"  />
                                                                     </apex:actionRegion>
                                                                    </td>
                                                                </tr>
                                                                
                                                                <tr>
                                                                    <td>

                                                                        <div>
                                                                            <label> <b>FromAddress</b></label>
                                                                        </div>
                                                                    </td>
                                                                   
                                                                    <td>
                                                                        <div>
                                                                            <label> <b>ToAddresses</b></label>
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <div>
                                                                            <label> <b>Subject</b></label>
                                                                        </div>
                                                                    </td>
                                                                    
                                                                    <td>
                                                                        <div>
                                                                            <label> <b>Attachment</b></label>
                                                                        </div>
                                                                    </td>
                                                                    
                                                                    <td>
                                                                        <div>
                                                                            <label> <b>RelatedTo</b></label>
                                                                        </div>
                                                                    </td>
                                                                </tr>

                                                               
                                                                <apex:repeat value="{!emailList }" var="email">
                                                                    <tr>
                                                                        <td>
                                                                             <div class="col-md-6 text" style="width: 150px;">
                                                                                <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!email.FromAddress__c}"  />
                                                                             </div>
                                                                         </td>
                                                                         <td>
                                                                             <div class="col-md-6 text" style="width: 150px;">
                                                                                <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!email.ToAddresses__c}"  />
                                                                             </div>
                                                                         </td>
                                                                         <td>
                                                                             <div class="col-md-6 text" style="width: 150px;">
                                                                                <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!email.Subject__c}"   />
                                                                             </div>
                                                                         </td>
                                                                         <td>
                                                                             <div class="col-md-6 text" style="width: 150px;">
                                                                                <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!email.Attachment__c}"  />
                                                                             </div>
                                                                         </td>
                                                                         <td>
                                                                             <div class="col-md-6 text" style="width: 150px;">
                                                                                <apex:outputField styleclass="slds-input" style="width: 101px;" value="{!email.NPD_Activity__r.Name__c}"  />
                                                                             </div>
                                                                         </td>

                                                                           

                                                                      </tr>

                                                                </apex:repeat>

                                                            </table>
                                                            
                                                                
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </apex:outputPanel>
                                    </apex:outputPanel>**-->
          <!--*************************************************************************************************************************************************************************-->
          <!--*************************************************Email History******************************************************************************-->
          <apex:outputPanel id="Successor">
             <apex:outputPanel id="Successorin" rendered="{!isSuccesoor}" style="overflow:scroll;height:50px;width:50px;">
                <div class="slds NPD" height="100%" width="100%">
                   <div class="slds-grid slds-wrap" id="theDivId">
                      <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                         <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 76%;background-color: aliceblue;margi;float: right;">
                               <tr>
                                  <td> </td>
                               </tr>
                               <tr>
                                  <td>
                                     <div> <label> <b>RelatedTo</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>SuccessorName</b></label> </div>
                                  </td>
                        <!--          <td>
                                     <div> <label> <b>Brand</b></label> </div>
                                  </td>
                                  <td>
                                     <div> <label> <b>Source</b></label> </div>
                                  </td>    -->
                                  <td style="width: 227px;">
                                     <div> <label> <b>Email</b></label> </div>
                                  </td>
                               </tr>
                               <apex:repeat value="{!lSuccessorEmailWrapper }" var="succ">
                                  <tr>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputtext style="width: 101px;" value="{!succ.relatedTo}"
                                           /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputText style="width: 101px;" value="{!succ.successorName}"
                                       rendered="{!if(succ.Type=='Successor',true,false)}" /> </div>
                                     </td>
                                  <!--   <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputtext style="width: 101px;" value="{!succ.brand}"
                                           /> </div>
                                     </td>
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputtext style="width: 101px;" value="{!succ.source}"
                                           /> </div>
                                     </td>  -->
                                     <td>
                                        <div class="col-md-6 text" style="width: 150px;">
                                           <apex:outputtext style="width: 101px;" value="{!succ.successorName}" rendered="{!if(succ.type=='Successor',false,true)}"
                                           />
                                           <apex:outputtext style="width: 101px;" value="{!succ.email}" rendered="{!if(succ.type=='Successor',true,false)}"
                                           /> </div>
                                     </td> 
                                  </tr>
                               </apex:repeat>
                            </table>
                         </div>
                      </div>
                   </div>
                </div>
             </apex:outputPanel>
          </apex:outputPanel>
          <!--*************************************************************************************************************************************************************************-->
       </apex:form>
       <apex:form >
          <apex:actionFunction name="showStageScreen" reRender="scrstage,scract,scrSubAct,buttonform,dynamicTable,dynamicTableData,attpanalstage,dynamicTable,dynamicTableData,dynamicTable"
             oncomplete="hideCol();" action="{!displayStageActivityScreen}">
             <apex:param value="edit" name="stgname" assignto="{!stagename}" />
             <apex:param value="edit" name="type" assignto="{!selectedType }" />
             <apex:param value="edit" name="id" assignto="{!selectedid }" /> </apex:actionFunction>
          <apex:actionFunction name="showActivityScreen" reRender="scrstage,scract,scrSubAct,attachform,attpanal11,attpanalstage,dynamicTable,dynamicTableData,dynamicTable,activitytask,activitynote,activityApprovalHistory,Successor"
             oncomplete="hideColact();" action="{!displayActivityScreen}">
             <apex:param value="edit" name="stgname" assignto="{!stagename}" />
             <apex:param value="edit" name="type" assignto="{!selectedType }" />
             <apex:param value="edit" name="id" assignto="{!selectedid }" /> </apex:actionFunction>
          <apex:actionFunction name="saveActivitycontroller" rerender="hoja" oncomplete="hideColact();"
             action="{!saveActivity}"> </apex:actionFunction>
       </apex:form>
       
       <apex:form id="attachform">
       
          <apex:outputPanel id="attupload" rendered="{!isAttach}" style="overflow:scroll;height:50px;width:50px;">
             <div class="slds NPD">
                <div class="slds-grid slds-wrap" id="theDivId">
                   <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                      <div class="slds-form--stacked"> <br/>
                         <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 200px;background-color: aliceblue;margin-left: 365px;margin-left: 315px;">
                            <tr>
                               <td>
                                  <!--<span class="slds-text-not-selected">
                                                                          <svg aria-hidden="true" class="slds-button__icon--stateful slds-button__icon--left">
                                                                       <apex:commandButton onclick="uploadFile();" class="slds-button slds-button--neutral slds-not-selected">Upload</button>                  
                                                                            </svg>--><span class="slds-text-not-selected">
                                                                            <svg aria-hidden="true" class="slds-button__icon--stateful slds-button__icon--left">
                                                                            
                                                                             <apex:actionRegion id="attachey" renderRegionOnly="true"> 
                                                                                <apex:commandButton onclick="uploadFile();"  rerender="attachform,attpanal11,attpanalstage"  oncomplete="hideColact();" styleclass="slds-button slds-button--neutral slds-not-selected"  value="Upload"    status="actStatusId" />                        
                                                                               </apex:actionRegion>
                                                                            </svg>
                                                                         </span> </td>
                               <td> <span class="slds-text-not-selected">
                                                                           <svg aria-hidden="true" class="slds-button__icon--stateful slds-button__icon--left">
                                                                            <apex:commandButton styleclass="slds-button slds-button--neutral slds-not-selected"  value="Cancel" action="{!cancelUpload}"   status="actStatusId" />                        
                                                                            </svg>
                                                                         </span> </td>
                            </tr>
                            <tr>
                               <td> <label class="col-md-6"> Attach File to {!attparentname}</label> </td>
                            </tr>
                            <tr>
                               <td style=" white-space: nowrap;"> <label class="col-md-6"> File</label>
                                  <div class="col-md-6 text" style="width: 200px;">
                                     <apex:inputFile fileName="{!attach1.name}" value="{!attach1.body}" id="file"></apex:inputFile>
                                  </div>
                               </td>
                               <td style=" white-space: nowrap;"> <label class="col-md-6"> Description</label>
                                  <div class="col-md-6 text" style="width: 200px;">
                                     <apex:inputtext styleclass="slds-input" value="{!attach1.Description}"> </apex:inputText>
                                  </div>
                               </td>
                            </tr>
                         </table>
                      </div>
                   </div>
                </div>
             </div>
          </apex:outputPanel>
          <apex:actionFunction name="uploadFileatt" action="{!uploadAttachment}" />
          
          <script>
          function uploadFile()
          {
             var r1 = confirm("Please save field value before uploading attachment");
             if(r1 == true)
             {
                uploadFileatt();
             }
          }
          </script>
          
          <!--<apex:actionFunction name="closeaatt"  rerender="attachform,attpanal11" action="{!dummy}" />--></apex:form>
       <!-- <apex:form id="sendemailform">
       
        <apex:outputPanel id="sendemailin" rendered="{!isEmailsend}" style="overflow:scroll;height:50px;width:50px;">

            <div class="slds NPD" height="100%" width="100%">
                <div class="slds-grid slds-wrap" id="theDivId">
                    <div class="slds-col--padded slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                        <div class="slds-form--stacked">
                            <table class="slds-table slds-table slds-max-medium-table--stacked" style="width: 404px;background-color: aliceblue;margin-left: 315px;margin-top: 2px;">
                               <apex:variable value="{!0}" var="row" />
                                <tr>
                                    <td style=" white-space: nowrap;">
                                        <label class="col-md-6"> To Addresses</label>
                                        <div class="col-md-6 text">
                                            <apex:inputText styleclass="slds-input" style="width: 200px;" value="{!toaddre}" />
                                        </div>
                                    </td>
                                  
                                      </tr>
                                      <tr>
                                    <td>
                                        <label class="col-md-6"> Subject</label>
                                        <div class="col-md-6 text" style="width: 315px;">
                                            <apex:inputText styleclass="slds-input" value="{!subject}" style="width: 200px;" id="Subject" maxlength="80" />
                                        </div>
                                    </td>
                                
                                </tr>
                                <tr>
                                    <td>
                                        <label class="col-md-6"> TextBody </label>
                                        <div class="col-md-6 text" style="width: 300px;">
                                            <apex:inputTextarea styleclass="slds-input" value="{!text1}" id="Body" rows="3" cols="5" />
                                        </div>
                                    </td>
                                   </tr>
                                     <tr>
                                    <td>
                                    <apex:inputFile fileName="{!attach.name}" value="{!attach.body}" styleclass="filetype" id="file"></apex:inputFile>
                                    </td>
                                    <tr>
                                    <td>
                                    <apex:actionRegion id="area51" renderRegionOnly="true"> 
                                         <apex:commandButton reRender="sendemail" value="Send Email"    onclick="showemail();return false;"  />
                                      </apex:actionRegion> 
                                    </td>
                                    </tr>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </apex:outputPanel>
        
        
         <apex:actionFunction name="showemailrendered"   action="{!send}">
         </apex:actionFunction>
        

        
        <script>
        function showemail(){
       
        showemailrendered();
         
        
        }
        
        function callrerender(){
            //alert('aaaaaaaaaaaaaaaaa');
        }
        </script>
        </apex:form> -->

       </html>
    </apex:page>